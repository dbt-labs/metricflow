test_name: test_offset_window_with_cumulative_input_metric
test_filename: test_offset_metrics.py
docstring:
  Test offset window metric that uses a cumulative metric with window as input.
---
metric_time__day       trailing_7_days_bookings    trailing_7_days_bookings_offset_1_week
-------------------  --------------------------  ----------------------------------------
2019-12-01T00:00:00                           1
2019-12-02T00:00:00                           1
2019-12-03T00:00:00                           1
2019-12-04T00:00:00                           1
2019-12-05T00:00:00                           1
2019-12-06T00:00:00                           1
2019-12-07T00:00:00                           1
2019-12-08T00:00:00                                                                     1
2019-12-09T00:00:00                                                                     1
2019-12-10T00:00:00                                                                     1
2019-12-11T00:00:00                                                                     1
2019-12-12T00:00:00                                                                     1
2019-12-13T00:00:00                                                                     1
2019-12-14T00:00:00                                                                     1
2019-12-18T00:00:00                          10
2019-12-19T00:00:00                          28
2019-12-20T00:00:00                          30
2019-12-21T00:00:00                          30
2019-12-22T00:00:00                          30
2019-12-23T00:00:00                          30
2019-12-24T00:00:00                          30
2019-12-25T00:00:00                          20                                        10
2019-12-26T00:00:00                           2                                        28
2019-12-27T00:00:00                                                                    30
2019-12-28T00:00:00                                                                    30
2019-12-29T00:00:00                                                                    30
2019-12-30T00:00:00                                                                    30
2019-12-31T00:00:00                                                                    30
2020-01-01T00:00:00                           5                                        20
2020-01-02T00:00:00                          14                                         2
2020-01-03T00:00:00                          15
2020-01-04T00:00:00                          15
2020-01-05T00:00:00                          15
2020-01-06T00:00:00                          15
2020-01-07T00:00:00                          15
2020-01-08T00:00:00                          10                                         5
2020-01-09T00:00:00                           1                                        14
2020-01-10T00:00:00                                                                    15
2020-01-11T00:00:00                                                                    15
2020-01-12T00:00:00                                                                    15
2020-01-13T00:00:00                                                                    15
2020-01-14T00:00:00                                                                    15
2020-01-15T00:00:00                                                                    10
2020-01-16T00:00:00                                                                     1
2020-02-01T00:00:00                           2
2020-02-02T00:00:00                           7
2020-02-03T00:00:00                           8
2020-02-04T00:00:00                          10
2020-02-05T00:00:00                          14
2020-02-06T00:00:00                          14
2020-02-07T00:00:00                          15
2020-02-08T00:00:00                          15                                         2
2020-02-09T00:00:00                          12                                         7
2020-02-10T00:00:00                          12                                         8
2020-02-11T00:00:00                          15                                        10
2020-02-12T00:00:00                          13                                        14
2020-02-13T00:00:00                          14                                        14
2020-02-14T00:00:00                          15                                        15
2020-02-15T00:00:00                          14                                        15
2020-02-16T00:00:00                          14                                        12
2020-02-17T00:00:00                          16                                        12
2020-02-18T00:00:00                          12                                        15
2020-02-19T00:00:00                          12                                        13
2020-02-20T00:00:00                          13                                        14
2020-02-21T00:00:00                          12                                        15
2020-02-22T00:00:00                          15                                        14
2020-02-23T00:00:00                          14                                        14
2020-02-24T00:00:00                          11                                        16
2020-02-25T00:00:00                          12                                        12
2020-02-26T00:00:00                          11                                        12
2020-02-27T00:00:00                          12                                        13
2020-02-28T00:00:00                          12                                        12
2020-02-29T00:00:00                           9                                        15
2020-03-01T00:00:00                          10                                        14
2020-03-02T00:00:00                          15                                        11
2020-03-03T00:00:00                          14                                        12
2020-03-04T00:00:00                          15                                        11
2020-03-05T00:00:00                          15                                        12
2020-03-06T00:00:00                          15                                        12
2020-03-07T00:00:00                          14                                         9
2020-03-08T00:00:00                          14                                        10
2020-03-09T00:00:00                          13                                        15
2020-03-10T00:00:00                          13                                        14
2020-03-11T00:00:00                          13                                        15
2020-03-12T00:00:00                          12                                        15
2020-03-13T00:00:00                          14                                        15
2020-03-14T00:00:00                          15                                        14
2020-03-15T00:00:00                          14                                        14
2020-03-16T00:00:00                          10                                        13
2020-03-17T00:00:00                          11                                        13
2020-03-18T00:00:00                          12                                        13
2020-03-19T00:00:00                          12                                        12
2020-03-20T00:00:00                          10                                        14
2020-03-21T00:00:00                          13                                        15
2020-03-22T00:00:00                          14                                        14
2020-03-23T00:00:00                          15                                        10
2020-03-24T00:00:00                          16                                        11
2020-03-25T00:00:00                          14                                        12
2020-03-26T00:00:00                          13                                        12
2020-03-27T00:00:00                          14                                        10
2020-03-28T00:00:00                          11                                        13
2020-03-29T00:00:00                          11                                        14
2020-03-30T00:00:00                          11                                        15
2020-03-31T00:00:00                           9                                        16
2020-04-01T00:00:00                          12                                        14
2020-04-02T00:00:00                          12                                        13
2020-04-03T00:00:00                          13                                        14
2020-04-04T00:00:00                          13                                        11
2020-04-05T00:00:00                          13                                        11
2020-04-06T00:00:00                          17                                        11
2020-04-07T00:00:00                          17                                         9
2020-04-08T00:00:00                          15                                        12
2020-04-09T00:00:00                          16                                        12
2020-04-10T00:00:00                          16                                        13
2020-04-11T00:00:00                          16                                        13
2020-04-12T00:00:00                          14                                        13
2020-04-13T00:00:00                          11                                        17
2020-04-14T00:00:00                          14                                        17
2020-04-15T00:00:00                          13                                        15
2020-04-16T00:00:00                          13                                        16
2020-04-17T00:00:00                          12                                        16
2020-04-18T00:00:00                          14                                        16
2020-04-19T00:00:00                          15                                        14
2020-04-20T00:00:00                          16                                        11
2020-04-21T00:00:00                          13                                        14
2020-04-22T00:00:00                          12                                        13
2020-04-23T00:00:00                          12                                        13
2020-04-24T00:00:00                          13                                        12
2020-04-25T00:00:00                          11                                        14
2020-04-26T00:00:00                          12                                        15
2020-04-27T00:00:00                          13                                        16
2020-04-28T00:00:00                          13                                        13
2020-04-29T00:00:00                          15                                        12
2020-04-30T00:00:00                          14                                        12
2020-05-01T00:00:00                          11                                        13
2020-05-02T00:00:00                          10                                        11
2020-05-03T00:00:00                           8                                        12
2020-05-04T00:00:00                           4                                        13
2020-05-05T00:00:00                           3                                        13
2020-05-06T00:00:00                           1                                        15
2020-05-07T00:00:00                                                                    14
2020-05-08T00:00:00                                                                    11
2020-05-09T00:00:00                                                                    10
2020-05-10T00:00:00                                                                     8
2020-05-11T00:00:00                                                                     4
2020-05-12T00:00:00                                                                     3
2020-05-13T00:00:00                                                                     1
2020-12-01T00:00:00                           2
2020-12-02T00:00:00                           6
2020-12-03T00:00:00                           7
2020-12-04T00:00:00                          10
2020-12-05T00:00:00                          12
2020-12-06T00:00:00                          12
2020-12-07T00:00:00                          14
2020-12-08T00:00:00                          15                                         2
2020-12-09T00:00:00                          15                                         6
2020-12-10T00:00:00                          15                                         7
2020-12-11T00:00:00                          14                                        10
2020-12-12T00:00:00                          15                                        12
2020-12-13T00:00:00                          18                                        12
2020-12-14T00:00:00                          17                                        14
2020-12-15T00:00:00                          18                                        15
2020-12-16T00:00:00                          16                                        15
2020-12-17T00:00:00                          18                                        15
2020-12-18T00:00:00                          17                                        14
2020-12-19T00:00:00                          14                                        15
2020-12-20T00:00:00                          14                                        18
2020-12-21T00:00:00                          15                                        17
2020-12-22T00:00:00                          15                                        18
2020-12-23T00:00:00                          14                                        16
2020-12-24T00:00:00                          13                                        18
2020-12-25T00:00:00                          15                                        17
2020-12-26T00:00:00                          17                                        14
2020-12-27T00:00:00                          15                                        14
2020-12-28T00:00:00                          17                                        15
2020-12-29T00:00:00                          15                                        15
2020-12-30T00:00:00                          17                                        14
2020-12-31T00:00:00                          16                                        13
2021-01-01T00:00:00                          13                                        15
2021-01-02T00:00:00                          11                                        17
2021-01-03T00:00:00                          10                                        15
2021-01-04T00:00:00                           6                                        17
2021-01-05T00:00:00                           4                                        15
2021-01-06T00:00:00                           1                                        17
2021-01-07T00:00:00                                                                    16
2021-01-08T00:00:00                                                                    13
2021-01-09T00:00:00                                                                    11
2021-01-10T00:00:00                                                                    10
2021-01-11T00:00:00                                                                     6
2021-01-12T00:00:00                                                                     4
2021-01-13T00:00:00                                                                     1
