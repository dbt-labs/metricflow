test_name: test_saved_query_explain
test_filename: test_cli.py
---
ðŸ”Ž SQL (remove --explain to see data or add --show-dataflow-plan to see the generated dataflow plan):

SELECT
  subq_1.metric_time__day AS metric_time__day
  , customers_src_10000.country AS customer__customer_country
  , SUM(subq_1.__transactions) AS transactions
  , SUM(subq_1.__quick_buy_transactions) AS quick_buy_transactions
FROM (
  SELECT
    DATE_TRUNC('day', ds) AS metric_time__day
    , id_customer AS customer
    , CASE WHEN CASE WHEN transaction_type_name = 'quick-buy' THEN TRUE ELSE FALSE END THEN 1 ELSE 0 END AS __quick_buy_transactions
    , 1 AS __transactions
  FROM "mf_tutorial"."main"."transactions" transactions_src_10000
) subq_1
LEFT OUTER JOIN
  "mf_tutorial"."main"."customers" customers_src_10000
ON
  subq_1.customer = customers_src_10000.id_customer
GROUP BY
  subq_1.metric_time__day
  , customers_src_10000.country
