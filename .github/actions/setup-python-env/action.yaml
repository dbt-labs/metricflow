name: Setup Python Environment
description: Install Python & Hatch

inputs:
  python-version:
    description: "Version of Python to use for testing"
    required: false
    default: '3.8'

runs:
  using: "composite"

  steps:
  - name: Set Linux Release Environment Variable
    shell: bash
    run: echo "LINUX_RELEASE=$(lsb_release -rs)" >> $GITHUB_ENV
  - name: Set up Python 3.9
    uses: actions/setup-python@v4
    with:
      python-version: "3.9"

  # Cache the dependencies installed by Hatch so that we don't need to reinstall them on every run.
  - uses: actions/cache@v3
    with:
      path: |
        ${{ env.pythonLocation }}
        # Save Hatch environments.
        ~/.local/share/hatch
        # Save the package cache for Hatch.
        ~/.cache/hatch
        # Save pre-commit environments.
        ~/.cache/pre-commit
      key: ${{ env.pythonLocation }}-${{ hashFiles('pyproject.toml') }}-${{ env.LINUX_RELEASE }}-000

  - name: Install Hatch
    shell: bash
    run: pip3 install hatch