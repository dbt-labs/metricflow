[0m16:29:47.488269 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__7ecsbtuo, now MetricFlow_request_mf_rid__wrlve1tb)
[0m16:29:47.489871 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__wrlve1tb"
[0m16:29:47.490167 [debug] [MainThread]: On MetricFlow_request_mf_rid__wrlve1tb: BEGIN
[0m16:29:47.490454 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:47.492237 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:47.492586 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__wrlve1tb"
[0m16:29:47.492866 [debug] [MainThread]: On MetricFlow_request_mf_rid__wrlve1tb: -- Aggregate Measures
-- Compute Metrics via Expressions
-- Order By ['host', 'guest']
SELECT
  guest
  , host
  , SUM(bookings) AS bookings
FROM (
  -- Read Elements From Semantic Model 'bookings_source'
  -- Metric Time Dimension 'ds'
  -- Pass Only Elements: ['bookings', 'host', 'guest']
  SELECT
    guest_id AS guest
    , host_id AS host
    , 1 AS bookings
  FROM *****.fct_bookings bookings_source_src_10000
) subq_2
GROUP BY
  guest
  , host
ORDER BY host, guest
[0m16:29:47.494614 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:47.495658 [debug] [MainThread]: On MetricFlow_request_mf_rid__wrlve1tb: ROLLBACK
[0m16:29:47.495991 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__wrlve1tb'
[0m16:29:47.496233 [debug] [MainThread]: On MetricFlow_request_mf_rid__wrlve1tb: Close
[0m16:29:47.497852 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__wrlve1tb, now MetricFlow_request_mf_rid__r4r27fwo)
[0m16:29:47.498155 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__r4r27fwo"
[0m16:29:47.498402 [debug] [MainThread]: On MetricFlow_request_mf_rid__r4r27fwo: BEGIN
[0m16:29:47.498634 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:47.498939 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:47.499171 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__r4r27fwo"
[0m16:29:47.499403 [debug] [MainThread]: On MetricFlow_request_mf_rid__r4r27fwo: SELECT
  SUM(1) AS bookings
  , guest_id AS guest
  , host_id AS host
FROM *****.fct_bookings
GROUP BY
  host_id
  , guest_id
ORDER BY
  host_id
  , guest_id
[0m16:29:47.500348 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:47.501377 [debug] [MainThread]: On MetricFlow_request_mf_rid__r4r27fwo: ROLLBACK
[0m16:29:47.501779 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__r4r27fwo'
[0m16:29:47.502064 [debug] [MainThread]: On MetricFlow_request_mf_rid__r4r27fwo: Close
[0m16:29:47.683251 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__r4r27fwo, now MetricFlow_request_mf_rid__b94mb8cl)
[0m16:29:47.683683 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__b94mb8cl"
[0m16:29:47.683952 [debug] [MainThread]: On MetricFlow_request_mf_rid__b94mb8cl: BEGIN
[0m16:29:47.684192 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:47.684573 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:47.684808 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__b94mb8cl"
[0m16:29:47.685047 [debug] [MainThread]: On MetricFlow_request_mf_rid__b94mb8cl: -- Read Elements From Semantic Model 'listings_latest'
-- Metric Time Dimension 'ds'
-- Pass Only Elements: ['largest_listing', 'metric_time__day']
-- Aggregate Measures
-- Compute Metrics via Expressions
SELECT
  DATE_TRUNC('day', created_at) AS metric_time__day
  , MAX(capacity) AS largest_listing
FROM *****.dim_listings_latest listings_latest_src_10000
GROUP BY
  DATE_TRUNC('day', created_at)
[0m16:29:47.686084 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:47.689071 [debug] [MainThread]: On MetricFlow_request_mf_rid__b94mb8cl: ROLLBACK
[0m16:29:47.689957 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__b94mb8cl'
[0m16:29:47.690260 [debug] [MainThread]: On MetricFlow_request_mf_rid__b94mb8cl: Close
[0m16:29:47.691945 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__b94mb8cl, now MetricFlow_request_mf_rid__0c21uecx)
[0m16:29:47.692261 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__0c21uecx"
[0m16:29:47.692507 [debug] [MainThread]: On MetricFlow_request_mf_rid__0c21uecx: BEGIN
[0m16:29:47.692738 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:47.693051 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:47.693283 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__0c21uecx"
[0m16:29:47.693515 [debug] [MainThread]: On MetricFlow_request_mf_rid__0c21uecx: SELECT
  MAX(capacity) as largest_listing
  , created_at AS metric_time__day
FROM *****.dim_listings_latest
GROUP BY
  2
[0m16:29:47.694301 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:47.695138 [debug] [MainThread]: On MetricFlow_request_mf_rid__0c21uecx: ROLLBACK
[0m16:29:47.695623 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__0c21uecx'
[0m16:29:47.695898 [debug] [MainThread]: On MetricFlow_request_mf_rid__0c21uecx: Close
[0m16:29:47.862279 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__0c21uecx, now MetricFlow_request_mf_rid__69xho0ze)
[0m16:29:47.862704 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__69xho0ze"
[0m16:29:47.862959 [debug] [MainThread]: On MetricFlow_request_mf_rid__69xho0ze: BEGIN
[0m16:29:47.863190 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:47.863560 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:47.863790 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__69xho0ze"
[0m16:29:47.864024 [debug] [MainThread]: On MetricFlow_request_mf_rid__69xho0ze: -- Read Elements From Semantic Model 'listings_latest'
-- Metric Time Dimension 'ds'
-- Pass Only Elements: ['smallest_listing', 'metric_time__day']
-- Aggregate Measures
-- Compute Metrics via Expressions
SELECT
  DATE_TRUNC('day', created_at) AS metric_time__day
  , MIN(capacity) AS smallest_listing
FROM *****.dim_listings_latest listings_latest_src_10000
GROUP BY
  DATE_TRUNC('day', created_at)
[0m16:29:47.864574 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:47.865371 [debug] [MainThread]: On MetricFlow_request_mf_rid__69xho0ze: ROLLBACK
[0m16:29:47.865683 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__69xho0ze'
[0m16:29:47.865913 [debug] [MainThread]: On MetricFlow_request_mf_rid__69xho0ze: Close
[0m16:29:47.867386 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__69xho0ze, now MetricFlow_request_mf_rid__vxc7tuwd)
[0m16:29:47.867673 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__vxc7tuwd"
[0m16:29:47.867909 [debug] [MainThread]: On MetricFlow_request_mf_rid__vxc7tuwd: BEGIN
[0m16:29:47.868133 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:47.868442 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:47.868672 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__vxc7tuwd"
[0m16:29:47.868907 [debug] [MainThread]: On MetricFlow_request_mf_rid__vxc7tuwd: SELECT
  MIN(capacity) as smallest_listing
  , created_at AS metric_time__day
  FROM *****.dim_listings_latest
  GROUP BY
    2
[0m16:29:47.869594 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:47.871771 [debug] [MainThread]: On MetricFlow_request_mf_rid__vxc7tuwd: ROLLBACK
[0m16:29:47.872494 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__vxc7tuwd'
[0m16:29:47.872759 [debug] [MainThread]: On MetricFlow_request_mf_rid__vxc7tuwd: Close
[0m16:29:48.072923 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__vxc7tuwd, now MetricFlow_request_mf_rid__v2o93z6k)
[0m16:29:48.073335 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__v2o93z6k"
[0m16:29:48.073730 [debug] [MainThread]: On MetricFlow_request_mf_rid__v2o93z6k: BEGIN
[0m16:29:48.073974 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:48.074341 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:48.074574 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__v2o93z6k"
[0m16:29:48.075934 [debug] [MainThread]: On MetricFlow_request_mf_rid__v2o93z6k: -- Aggregate Measures
-- Compute Metrics via Expressions
SELECT
  metric_time__day
  , SUM(listings) AS listings
FROM (
  -- Read Elements From Semantic Model 'listings_latest'
  -- Metric Time Dimension 'ds'
  -- Pass Only Elements: ['listings', 'metric_time__day']
  SELECT
    DATE_TRUNC('day', created_at) AS metric_time__day
    , 1 AS listings
  FROM *****.dim_listings_latest listings_latest_src_10000
) subq_2
GROUP BY
  metric_time__day
[0m16:29:48.077436 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:48.078306 [debug] [MainThread]: On MetricFlow_request_mf_rid__v2o93z6k: ROLLBACK
[0m16:29:48.078669 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__v2o93z6k'
[0m16:29:48.078910 [debug] [MainThread]: On MetricFlow_request_mf_rid__v2o93z6k: Close
[0m16:29:48.080571 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__v2o93z6k, now MetricFlow_request_mf_rid__ll18s7i2)
[0m16:29:48.080931 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__ll18s7i2"
[0m16:29:48.081189 [debug] [MainThread]: On MetricFlow_request_mf_rid__ll18s7i2: BEGIN
[0m16:29:48.081507 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:48.081865 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:48.082102 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__ll18s7i2"
[0m16:29:48.082333 [debug] [MainThread]: On MetricFlow_request_mf_rid__ll18s7i2: SELECT
  SUM(1) as listings
  , created_at AS metric_time__day
  FROM *****.dim_listings_latest
  GROUP BY
    2
[0m16:29:48.083087 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:48.084063 [debug] [MainThread]: On MetricFlow_request_mf_rid__ll18s7i2: ROLLBACK
[0m16:29:48.084393 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__ll18s7i2'
[0m16:29:48.084639 [debug] [MainThread]: On MetricFlow_request_mf_rid__ll18s7i2: Close
[0m16:29:48.423617 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__ll18s7i2, now MetricFlow_request_mf_rid__0coa9nbc)
[0m16:29:48.424061 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__0coa9nbc"
[0m16:29:48.424316 [debug] [MainThread]: On MetricFlow_request_mf_rid__0coa9nbc: BEGIN
[0m16:29:48.425366 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:48.427067 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:48.427335 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__0coa9nbc"
[0m16:29:48.427586 [debug] [MainThread]: On MetricFlow_request_mf_rid__0coa9nbc: -- Read Elements From Semantic Model 'bookings_source'
-- Metric Time Dimension 'ds'
-- Pass Only Elements: ['bookers', 'metric_time__day']
-- Aggregate Measures
-- Compute Metrics via Expressions
SELECT
  DATE_TRUNC('day', ds) AS metric_time__day
  , COUNT(DISTINCT guest_id) AS bookers
FROM *****.fct_bookings bookings_source_src_10000
GROUP BY
  DATE_TRUNC('day', ds)
[0m16:29:48.428659 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:48.429603 [debug] [MainThread]: On MetricFlow_request_mf_rid__0coa9nbc: ROLLBACK
[0m16:29:48.430908 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__0coa9nbc'
[0m16:29:48.431452 [debug] [MainThread]: On MetricFlow_request_mf_rid__0coa9nbc: Close
[0m16:29:48.433180 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__0coa9nbc, now MetricFlow_request_mf_rid__9wd1dcmr)
[0m16:29:48.433502 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__9wd1dcmr"
[0m16:29:48.433751 [debug] [MainThread]: On MetricFlow_request_mf_rid__9wd1dcmr: BEGIN
[0m16:29:48.433982 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:48.436408 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:48.436825 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__9wd1dcmr"
[0m16:29:48.437246 [debug] [MainThread]: On MetricFlow_request_mf_rid__9wd1dcmr: SELECT
  COUNT(DISTINCT guest_id) as bookers
  , ds AS metric_time__day
  FROM *****.fct_bookings
  GROUP BY
    2
[0m16:29:48.443723 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:48.444833 [debug] [MainThread]: On MetricFlow_request_mf_rid__9wd1dcmr: ROLLBACK
[0m16:29:48.445173 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__9wd1dcmr'
[0m16:29:48.445424 [debug] [MainThread]: On MetricFlow_request_mf_rid__9wd1dcmr: Close
[0m16:29:48.650763 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__9wd1dcmr, now MetricFlow_request_mf_rid__o9fm4hde)
[0m16:29:48.651216 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__o9fm4hde"
[0m16:29:48.651474 [debug] [MainThread]: On MetricFlow_request_mf_rid__o9fm4hde: BEGIN
[0m16:29:48.651706 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:48.652088 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:48.652316 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__o9fm4hde"
[0m16:29:48.652549 [debug] [MainThread]: On MetricFlow_request_mf_rid__o9fm4hde: -- Read Elements From Semantic Model 'bookings_source'
-- Metric Time Dimension 'ds'
-- Pass Only Elements: ['average_booking_value', 'metric_time__day']
-- Aggregate Measures
-- Compute Metrics via Expressions
SELECT
  DATE_TRUNC('day', ds) AS metric_time__day
  , AVG(booking_value) AS average_booking_value
FROM *****.fct_bookings bookings_source_src_10000
GROUP BY
  DATE_TRUNC('day', ds)
[0m16:29:48.654150 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:48.655475 [debug] [MainThread]: On MetricFlow_request_mf_rid__o9fm4hde: ROLLBACK
[0m16:29:48.655869 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__o9fm4hde'
[0m16:29:48.656162 [debug] [MainThread]: On MetricFlow_request_mf_rid__o9fm4hde: Close
[0m16:29:48.657997 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__o9fm4hde, now MetricFlow_request_mf_rid__s7x0dsz6)
[0m16:29:48.658400 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__s7x0dsz6"
[0m16:29:48.658664 [debug] [MainThread]: On MetricFlow_request_mf_rid__s7x0dsz6: BEGIN
[0m16:29:48.658900 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:48.659275 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:48.659671 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__s7x0dsz6"
[0m16:29:48.659919 [debug] [MainThread]: On MetricFlow_request_mf_rid__s7x0dsz6: SELECT
  AVG(CAST(booking_value AS DOUBLE)) as average_booking_value
  , ds AS metric_time__day
FROM *****.fct_bookings
GROUP BY
  ds
[0m16:29:48.660616 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:48.662821 [debug] [MainThread]: On MetricFlow_request_mf_rid__s7x0dsz6: ROLLBACK
[0m16:29:48.663263 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__s7x0dsz6'
[0m16:29:48.663524 [debug] [MainThread]: On MetricFlow_request_mf_rid__s7x0dsz6: Close
[0m16:29:48.879678 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__s7x0dsz6, now MetricFlow_request_mf_rid__b54f92ho)
[0m16:29:48.880153 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__b54f92ho"
[0m16:29:48.880420 [debug] [MainThread]: On MetricFlow_request_mf_rid__b54f92ho: BEGIN
[0m16:29:48.880654 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:48.881032 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:48.881265 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__b54f92ho"
[0m16:29:48.881506 [debug] [MainThread]: On MetricFlow_request_mf_rid__b54f92ho: -- Aggregate Measures
-- Compute Metrics via Expressions
SELECT
  metric_time__day
  , SUM(instant_bookings) AS instant_bookings
FROM (
  -- Read Elements From Semantic Model 'bookings_source'
  -- Metric Time Dimension 'ds'
  -- Pass Only Elements: ['instant_bookings', 'metric_time__day']
  SELECT
    DATE_TRUNC('day', ds) AS metric_time__day
    , CASE WHEN is_instant THEN 1 ELSE 0 END AS instant_bookings
  FROM *****.fct_bookings bookings_source_src_10000
) subq_2
GROUP BY
  metric_time__day
[0m16:29:48.882500 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:48.886542 [debug] [MainThread]: On MetricFlow_request_mf_rid__b54f92ho: ROLLBACK
[0m16:29:48.887487 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__b54f92ho'
[0m16:29:48.888076 [debug] [MainThread]: On MetricFlow_request_mf_rid__b54f92ho: Close
[0m16:29:48.889871 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__b54f92ho, now MetricFlow_request_mf_rid__1aoa6k3f)
[0m16:29:48.890764 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__1aoa6k3f"
[0m16:29:48.892230 [debug] [MainThread]: On MetricFlow_request_mf_rid__1aoa6k3f: BEGIN
[0m16:29:48.892910 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:48.893853 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:48.894646 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__1aoa6k3f"
[0m16:29:48.894924 [debug] [MainThread]: On MetricFlow_request_mf_rid__1aoa6k3f: SELECT
  SUM(CASE WHEN is_instant THEN 1 ELSE 0 END) AS instant_bookings
  , ds AS metric_time__day
FROM *****.fct_bookings
GROUP BY
  ds
[0m16:29:48.895701 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:48.900999 [debug] [MainThread]: On MetricFlow_request_mf_rid__1aoa6k3f: ROLLBACK
[0m16:29:48.901440 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__1aoa6k3f'
[0m16:29:48.901689 [debug] [MainThread]: On MetricFlow_request_mf_rid__1aoa6k3f: Close
[0m16:29:49.138609 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__1aoa6k3f, now MetricFlow_request_mf_rid__mwms3lux)
[0m16:29:49.139045 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__mwms3lux"
[0m16:29:49.139296 [debug] [MainThread]: On MetricFlow_request_mf_rid__mwms3lux: BEGIN
[0m16:29:49.139530 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:49.139903 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:49.140133 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__mwms3lux"
[0m16:29:49.140378 [debug] [MainThread]: On MetricFlow_request_mf_rid__mwms3lux: -- Aggregate Measures
-- Compute Metrics via Expressions
SELECT
  metric_time__day
  , SUM(referred_bookings) AS referred_bookings
FROM (
  -- Read Elements From Semantic Model 'bookings_source'
  -- Metric Time Dimension 'ds'
  -- Pass Only Elements: ['referred_bookings', 'metric_time__day']
  SELECT
    DATE_TRUNC('day', ds) AS metric_time__day
    , CASE WHEN referrer_id IS NOT NULL THEN 1 ELSE 0 END AS referred_bookings
  FROM *****.fct_bookings bookings_source_src_10000
) subq_2
GROUP BY
  metric_time__day
[0m16:29:49.141004 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:49.141892 [debug] [MainThread]: On MetricFlow_request_mf_rid__mwms3lux: ROLLBACK
[0m16:29:49.142261 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__mwms3lux'
[0m16:29:49.142504 [debug] [MainThread]: On MetricFlow_request_mf_rid__mwms3lux: Close
[0m16:29:49.144152 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__mwms3lux, now MetricFlow_request_mf_rid__0zkt02uh)
[0m16:29:49.144512 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__0zkt02uh"
[0m16:29:49.144771 [debug] [MainThread]: On MetricFlow_request_mf_rid__0zkt02uh: BEGIN
[0m16:29:49.145000 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:49.145363 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:49.145593 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__0zkt02uh"
[0m16:29:49.145822 [debug] [MainThread]: On MetricFlow_request_mf_rid__0zkt02uh: SELECT
  SUM(CASE WHEN referrer_id IS NOT NULL THEN 1 ELSE 0 END) AS referred_bookings
  , ds AS metric_time__day
FROM *****.fct_bookings
GROUP BY
  ds
[0m16:29:49.146779 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:49.147678 [debug] [MainThread]: On MetricFlow_request_mf_rid__0zkt02uh: ROLLBACK
[0m16:29:49.148019 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__0zkt02uh'
[0m16:29:49.148266 [debug] [MainThread]: On MetricFlow_request_mf_rid__0zkt02uh: Close
[0m16:29:49.361450 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__0zkt02uh, now MetricFlow_request_mf_rid__23fofr8i)
[0m16:29:49.361942 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__23fofr8i"
[0m16:29:49.362206 [debug] [MainThread]: On MetricFlow_request_mf_rid__23fofr8i: BEGIN
[0m16:29:49.362445 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:49.362833 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:49.363072 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__23fofr8i"
[0m16:29:49.363313 [debug] [MainThread]: On MetricFlow_request_mf_rid__23fofr8i: -- Aggregate Measures
-- Compute Metrics via Expressions
SELECT
  metric_time__day
  , SUM(referred_bookings) AS referred_bookings
FROM (
  -- Read Elements From Semantic Model 'bookings_source'
  -- Metric Time Dimension 'ds'
  -- Pass Only Elements: ['referred_bookings', 'metric_time__day']
  SELECT
    DATE_TRUNC('day', ds) AS metric_time__day
    , CASE WHEN referrer_id IS NOT NULL THEN 1 ELSE 0 END AS referred_bookings
  FROM *****.fct_bookings bookings_source_src_10000
) subq_2
GROUP BY
  metric_time__day
[0m16:29:49.364300 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:49.365377 [debug] [MainThread]: On MetricFlow_request_mf_rid__23fofr8i: ROLLBACK
[0m16:29:49.365774 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__23fofr8i'
[0m16:29:49.366023 [debug] [MainThread]: On MetricFlow_request_mf_rid__23fofr8i: Close
[0m16:29:49.369677 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__23fofr8i, now MetricFlow_request_mf_rid__9ax4tn7o)
[0m16:29:49.370595 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__9ax4tn7o"
[0m16:29:49.372442 [debug] [MainThread]: On MetricFlow_request_mf_rid__9ax4tn7o: BEGIN
[0m16:29:49.373382 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:49.374906 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:49.375251 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__9ax4tn7o"
[0m16:29:49.375510 [debug] [MainThread]: On MetricFlow_request_mf_rid__9ax4tn7o: SELECT
  COUNT(referrer_id) AS referred_bookings
  , ds AS metric_time__day
FROM *****.fct_bookings
GROUP BY
  ds
[0m16:29:49.376591 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:49.377697 [debug] [MainThread]: On MetricFlow_request_mf_rid__9ax4tn7o: ROLLBACK
[0m16:29:49.378086 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__9ax4tn7o'
[0m16:29:49.378337 [debug] [MainThread]: On MetricFlow_request_mf_rid__9ax4tn7o: Close
[0m16:29:49.701100 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__9ax4tn7o, now MetricFlow_request_mf_rid__3datedc9)
[0m16:29:49.701558 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__3datedc9"
[0m16:29:49.701822 [debug] [MainThread]: On MetricFlow_request_mf_rid__3datedc9: BEGIN
[0m16:29:49.702063 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:49.704252 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:49.704995 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__3datedc9"
[0m16:29:49.705307 [debug] [MainThread]: On MetricFlow_request_mf_rid__3datedc9: -- Read Elements From Semantic Model 'bookings_source'
-- Metric Time Dimension 'ds'
-- Pass Only Elements: ['booking_value_p99', 'metric_time__day']
-- Aggregate Measures
-- Compute Metrics via Expressions
SELECT
  DATE_TRUNC('day', ds) AS metric_time__day
  , PERCENTILE_CONT(0.99) WITHIN GROUP (ORDER BY (booking_value)) AS booking_value_p99
FROM *****.fct_bookings bookings_source_src_10000
GROUP BY
  DATE_TRUNC('day', ds)
[0m16:29:49.708633 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:49.709656 [debug] [MainThread]: On MetricFlow_request_mf_rid__3datedc9: ROLLBACK
[0m16:29:49.709988 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__3datedc9'
[0m16:29:49.710227 [debug] [MainThread]: On MetricFlow_request_mf_rid__3datedc9: Close
[0m16:29:49.712056 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__3datedc9, now MetricFlow_request_mf_rid__tukowm89)
[0m16:29:49.712386 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__tukowm89"
[0m16:29:49.712632 [debug] [MainThread]: On MetricFlow_request_mf_rid__tukowm89: BEGIN
[0m16:29:49.712862 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:49.713221 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:49.713450 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__tukowm89"
[0m16:29:49.713674 [debug] [MainThread]: On MetricFlow_request_mf_rid__tukowm89: SELECT
  PERCENTILE_CONT(0.99) WITHIN GROUP (ORDER BY (booking_value)) AS booking_value_p99
  , ds AS metric_time__day
FROM *****.fct_bookings
GROUP BY
  ds
[0m16:29:49.714458 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:49.716595 [debug] [MainThread]: On MetricFlow_request_mf_rid__tukowm89: ROLLBACK
[0m16:29:49.717589 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__tukowm89'
[0m16:29:49.718242 [debug] [MainThread]: On MetricFlow_request_mf_rid__tukowm89: Close
[0m16:29:49.953441 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__tukowm89, now MetricFlow_request_mf_rid__62i4z825)
[0m16:29:49.953879 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__62i4z825"
[0m16:29:49.954134 [debug] [MainThread]: On MetricFlow_request_mf_rid__62i4z825: BEGIN
[0m16:29:49.954370 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:49.954742 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:49.954975 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__62i4z825"
[0m16:29:49.955216 [debug] [MainThread]: On MetricFlow_request_mf_rid__62i4z825: -- Read Elements From Semantic Model 'bookings_source'
-- Metric Time Dimension 'ds'
-- Pass Only Elements: ['discrete_booking_value_p99', 'metric_time__day']
-- Aggregate Measures
-- Compute Metrics via Expressions
SELECT
  DATE_TRUNC('day', ds) AS metric_time__day
  , PERCENTILE_DISC(0.99) WITHIN GROUP (ORDER BY (booking_value)) AS discrete_booking_value_p99
FROM *****.fct_bookings bookings_source_src_10000
GROUP BY
  DATE_TRUNC('day', ds)
[0m16:29:49.961303 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:49.962312 [debug] [MainThread]: On MetricFlow_request_mf_rid__62i4z825: ROLLBACK
[0m16:29:49.962649 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__62i4z825'
[0m16:29:49.962891 [debug] [MainThread]: On MetricFlow_request_mf_rid__62i4z825: Close
[0m16:29:49.965991 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__62i4z825, now MetricFlow_request_mf_rid__07awxmzh)
[0m16:29:49.966444 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__07awxmzh"
[0m16:29:49.966959 [debug] [MainThread]: On MetricFlow_request_mf_rid__07awxmzh: BEGIN
[0m16:29:49.967251 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:49.967668 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:49.967927 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__07awxmzh"
[0m16:29:49.968169 [debug] [MainThread]: On MetricFlow_request_mf_rid__07awxmzh: SELECT
  PERCENTILE_DISC(0.99) WITHIN GROUP (ORDER BY (booking_value)) AS discrete_booking_value_p99
  , ds AS metric_time__day
FROM *****.fct_bookings
GROUP BY
  ds
[0m16:29:49.969021 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:49.970081 [debug] [MainThread]: On MetricFlow_request_mf_rid__07awxmzh: ROLLBACK
[0m16:29:49.971025 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__07awxmzh'
[0m16:29:49.971734 [debug] [MainThread]: On MetricFlow_request_mf_rid__07awxmzh: Close
[0m16:29:50.354859 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__07awxmzh, now MetricFlow_request_mf_rid__ek4h32t7)
[0m16:29:50.355269 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__ek4h32t7"
[0m16:29:50.355525 [debug] [MainThread]: On MetricFlow_request_mf_rid__ek4h32t7: BEGIN
[0m16:29:50.355768 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:50.356143 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:50.356381 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__ek4h32t7"
[0m16:29:50.356619 [debug] [MainThread]: On MetricFlow_request_mf_rid__ek4h32t7: -- Read Elements From Semantic Model 'bookings_source'
-- Metric Time Dimension 'ds'
-- Pass Only Elements: ['approximate_continuous_booking_value_p99', 'metric_time__day']
-- Aggregate Measures
-- Compute Metrics via Expressions
SELECT
  DATE_TRUNC('day', ds) AS metric_time__day
  , approx_quantile(booking_value, 0.99) AS approximate_continuous_booking_value_p99
FROM *****.fct_bookings bookings_source_src_10000
GROUP BY
  DATE_TRUNC('day', ds)
[0m16:29:50.364661 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:50.365671 [debug] [MainThread]: On MetricFlow_request_mf_rid__ek4h32t7: ROLLBACK
[0m16:29:50.366027 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__ek4h32t7'
[0m16:29:50.366280 [debug] [MainThread]: On MetricFlow_request_mf_rid__ek4h32t7: Close
[0m16:29:50.368190 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__ek4h32t7, now MetricFlow_request_mf_rid__9vnddzuc)
[0m16:29:50.368512 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__9vnddzuc"
[0m16:29:50.368765 [debug] [MainThread]: On MetricFlow_request_mf_rid__9vnddzuc: BEGIN
[0m16:29:50.368996 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:50.369337 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:50.369569 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__9vnddzuc"
[0m16:29:50.369798 [debug] [MainThread]: On MetricFlow_request_mf_rid__9vnddzuc: SELECT
  approx_quantile(booking_value, 0.99) AS approximate_continuous_booking_value_p99
  , ds AS metric_time__day
FROM *****.fct_bookings
GROUP BY
  ds
[0m16:29:50.370467 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:50.371367 [debug] [MainThread]: On MetricFlow_request_mf_rid__9vnddzuc: ROLLBACK
[0m16:29:50.374234 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__9vnddzuc'
[0m16:29:50.374618 [debug] [MainThread]: On MetricFlow_request_mf_rid__9vnddzuc: Close
[0m16:29:50.656474 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__9vnddzuc, now MetricFlow_request_mf_rid__nwtzbm1f)
[0m16:29:50.657641 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__nwtzbm1f"
[0m16:29:50.657939 [debug] [MainThread]: On MetricFlow_request_mf_rid__nwtzbm1f: BEGIN
[0m16:29:50.658179 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:50.658556 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:50.658815 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__nwtzbm1f"
[0m16:29:50.659058 [debug] [MainThread]: On MetricFlow_request_mf_rid__nwtzbm1f: -- Constrain Output with WHERE
-- Aggregate Measures
-- Compute Metrics via Expressions
SELECT
  booking__is_instant
  , SUM(booking_value) AS booking_value
FROM (
  -- Read Elements From Semantic Model 'bookings_source'
  -- Metric Time Dimension 'ds'
  -- Pass Only Elements: ['booking_value', 'booking__is_instant']
  SELECT
    is_instant AS booking__is_instant
    , booking_value
  FROM *****.fct_bookings bookings_source_src_10000
) subq_2
WHERE booking__is_instant
GROUP BY
  booking__is_instant
[0m16:29:50.659677 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:50.660470 [debug] [MainThread]: On MetricFlow_request_mf_rid__nwtzbm1f: ROLLBACK
[0m16:29:50.660768 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__nwtzbm1f'
[0m16:29:50.660993 [debug] [MainThread]: On MetricFlow_request_mf_rid__nwtzbm1f: Close
[0m16:29:50.662643 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__nwtzbm1f, now MetricFlow_request_mf_rid__0rwkxmu7)
[0m16:29:50.662965 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__0rwkxmu7"
[0m16:29:50.663212 [debug] [MainThread]: On MetricFlow_request_mf_rid__0rwkxmu7: BEGIN
[0m16:29:50.663467 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:50.663797 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:50.664038 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__0rwkxmu7"
[0m16:29:50.664280 [debug] [MainThread]: On MetricFlow_request_mf_rid__0rwkxmu7: SELECT
  SUM(booking_value) AS booking_value
  , is_instant AS booking__is_instant
FROM *****.fct_bookings
WHERE
  is_instant
GROUP BY
  is_instant
[0m16:29:50.664862 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:50.665661 [debug] [MainThread]: On MetricFlow_request_mf_rid__0rwkxmu7: ROLLBACK
[0m16:29:50.665957 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__0rwkxmu7'
[0m16:29:50.666192 [debug] [MainThread]: On MetricFlow_request_mf_rid__0rwkxmu7: Close
[0m16:29:50.854541 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__0rwkxmu7, now MetricFlow_request_mf_rid__u1k0vc0h)
[0m16:29:50.854976 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__u1k0vc0h"
[0m16:29:50.855229 [debug] [MainThread]: On MetricFlow_request_mf_rid__u1k0vc0h: BEGIN
[0m16:29:50.855467 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:50.855977 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:50.856258 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__u1k0vc0h"
[0m16:29:50.856510 [debug] [MainThread]: On MetricFlow_request_mf_rid__u1k0vc0h: -- Read Elements From Semantic Model 'bookings_source'
-- Metric Time Dimension 'ds'
-- Pass Only Elements: ['booking_value', 'booking__is_instant']
-- Aggregate Measures
-- Compute Metrics via Expressions
SELECT
  is_instant AS booking__is_instant
  , SUM(booking_value) AS booking_value
FROM *****.fct_bookings bookings_source_src_10000
GROUP BY
  is_instant
[0m16:29:50.857163 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:50.858001 [debug] [MainThread]: On MetricFlow_request_mf_rid__u1k0vc0h: ROLLBACK
[0m16:29:50.858330 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__u1k0vc0h'
[0m16:29:50.858605 [debug] [MainThread]: On MetricFlow_request_mf_rid__u1k0vc0h: Close
[0m16:29:50.860161 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__u1k0vc0h, now MetricFlow_request_mf_rid__46oflzvd)
[0m16:29:50.860457 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__46oflzvd"
[0m16:29:50.860691 [debug] [MainThread]: On MetricFlow_request_mf_rid__46oflzvd: BEGIN
[0m16:29:50.860930 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:50.861223 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:50.861451 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__46oflzvd"
[0m16:29:50.861678 [debug] [MainThread]: On MetricFlow_request_mf_rid__46oflzvd: SELECT
  SUM(booking_value) AS booking_value
  , is_instant AS booking__is_instant
FROM *****.fct_bookings
GROUP BY
  is_instant
ORDER BY
  booking_value DESC
[0m16:29:50.862226 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:50.862959 [debug] [MainThread]: On MetricFlow_request_mf_rid__46oflzvd: ROLLBACK
[0m16:29:50.863242 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__46oflzvd'
[0m16:29:50.863466 [debug] [MainThread]: On MetricFlow_request_mf_rid__46oflzvd: Close
[0m16:29:51.200626 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__46oflzvd, now MetricFlow_request_mf_rid__znn2ld73)
[0m16:29:51.201034 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__znn2ld73"
[0m16:29:51.201287 [debug] [MainThread]: On MetricFlow_request_mf_rid__znn2ld73: BEGIN
[0m16:29:51.201518 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:51.201857 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:51.202088 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__znn2ld73"
[0m16:29:51.202330 [debug] [MainThread]: On MetricFlow_request_mf_rid__znn2ld73: -- Aggregate Measures
-- Compute Metrics via Expressions
-- Order By ['booking_value']
SELECT
  metric_time__day
  , SUM(bookings) AS bookings
  , SUM(booking_value) AS booking_value
FROM (
  -- Read Elements From Semantic Model 'bookings_source'
  -- Metric Time Dimension 'ds'
  -- Pass Only Elements: ['bookings', 'booking_value', 'metric_time__day']
  SELECT
    DATE_TRUNC('day', ds) AS metric_time__day
    , 1 AS bookings
    , booking_value
  FROM *****.fct_bookings bookings_source_src_10000
) subq_2
GROUP BY
  metric_time__day
ORDER BY booking_value DESC
[0m16:29:51.202902 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:51.203762 [debug] [MainThread]: On MetricFlow_request_mf_rid__znn2ld73: ROLLBACK
[0m16:29:51.204060 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__znn2ld73'
[0m16:29:51.204298 [debug] [MainThread]: On MetricFlow_request_mf_rid__znn2ld73: Close
[0m16:29:51.206045 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__znn2ld73, now MetricFlow_request_mf_rid__8i6knz78)
[0m16:29:51.206393 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__8i6knz78"
[0m16:29:51.206643 [debug] [MainThread]: On MetricFlow_request_mf_rid__8i6knz78: BEGIN
[0m16:29:51.206925 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:51.207316 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:51.207559 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__8i6knz78"
[0m16:29:51.207807 [debug] [MainThread]: On MetricFlow_request_mf_rid__8i6knz78: SELECT
  SUM(1) AS bookings
  , SUM(booking_value) AS booking_value
  , ds AS metric_time__day
FROM *****.fct_bookings
GROUP BY
  ds
ORDER BY
  booking_value DESC
[0m16:29:51.208456 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:51.209286 [debug] [MainThread]: On MetricFlow_request_mf_rid__8i6knz78: ROLLBACK
[0m16:29:51.209579 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__8i6knz78'
[0m16:29:51.209806 [debug] [MainThread]: On MetricFlow_request_mf_rid__8i6knz78: Close
[0m16:29:51.553592 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__8i6knz78, now MetricFlow_request_mf_rid__ur19296u)
[0m16:29:51.553986 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__ur19296u"
[0m16:29:51.554240 [debug] [MainThread]: On MetricFlow_request_mf_rid__ur19296u: BEGIN
[0m16:29:51.554484 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:51.554840 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:51.555081 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__ur19296u"
[0m16:29:51.555328 [debug] [MainThread]: On MetricFlow_request_mf_rid__ur19296u: -- Aggregate Measures
-- Compute Metrics via Expressions
-- Order By ['metric_time__day']
SELECT
  metric_time__day
  , SUM(bookings) AS bookings
  , SUM(booking_value) AS booking_value
FROM (
  -- Read Elements From Semantic Model 'bookings_source'
  -- Metric Time Dimension 'ds'
  -- Pass Only Elements: ['bookings', 'booking_value', 'metric_time__day']
  SELECT
    DATE_TRUNC('day', ds) AS metric_time__day
    , 1 AS bookings
    , booking_value
  FROM *****.fct_bookings bookings_source_src_10000
) subq_2
GROUP BY
  metric_time__day
ORDER BY metric_time__day DESC
[0m16:29:51.556084 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:51.557077 [debug] [MainThread]: On MetricFlow_request_mf_rid__ur19296u: ROLLBACK
[0m16:29:51.557714 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__ur19296u'
[0m16:29:51.558029 [debug] [MainThread]: On MetricFlow_request_mf_rid__ur19296u: Close
[0m16:29:51.559771 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__ur19296u, now MetricFlow_request_mf_rid__nrl0b3m5)
[0m16:29:51.560077 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__nrl0b3m5"
[0m16:29:51.560321 [debug] [MainThread]: On MetricFlow_request_mf_rid__nrl0b3m5: BEGIN
[0m16:29:51.560711 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:51.561059 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:51.561301 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__nrl0b3m5"
[0m16:29:51.561541 [debug] [MainThread]: On MetricFlow_request_mf_rid__nrl0b3m5: SELECT
  SUM(1) AS bookings
  , SUM(booking_value) AS booking_value
  , ds AS metric_time__day
FROM *****.fct_bookings
GROUP BY
  ds
ORDER BY
  booking_value DESC
[0m16:29:51.564913 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:51.565927 [debug] [MainThread]: On MetricFlow_request_mf_rid__nrl0b3m5: ROLLBACK
[0m16:29:51.566254 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__nrl0b3m5'
[0m16:29:51.566502 [debug] [MainThread]: On MetricFlow_request_mf_rid__nrl0b3m5: Close
[0m16:29:51.800666 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__nrl0b3m5, now MetricFlow_request_mf_rid__m1f7x4ec)
[0m16:29:51.801114 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__m1f7x4ec"
[0m16:29:51.801368 [debug] [MainThread]: On MetricFlow_request_mf_rid__m1f7x4ec: BEGIN
[0m16:29:51.801604 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:51.801978 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:51.802209 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__m1f7x4ec"
[0m16:29:51.802453 [debug] [MainThread]: On MetricFlow_request_mf_rid__m1f7x4ec: -- Join Standard Outputs
-- Pass Only Elements: ['booking_value', 'booking__is_instant', 'listing__country_latest']
-- Aggregate Measures
-- Compute Metrics via Expressions
SELECT
  bookings_source_src_10000.is_instant AS booking__is_instant
  , listings_latest_src_10000.country AS listing__country_latest
  , SUM(bookings_source_src_10000.booking_value) AS booking_value
FROM *****.fct_bookings bookings_source_src_10000
LEFT OUTER JOIN
  *****.dim_listings_latest listings_latest_src_10000
ON
  bookings_source_src_10000.listing_id = listings_latest_src_10000.listing_id
GROUP BY
  bookings_source_src_10000.is_instant
  , listings_latest_src_10000.country
[0m16:29:51.803570 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:51.805992 [debug] [MainThread]: On MetricFlow_request_mf_rid__m1f7x4ec: ROLLBACK
[0m16:29:51.807163 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__m1f7x4ec'
[0m16:29:51.808035 [debug] [MainThread]: On MetricFlow_request_mf_rid__m1f7x4ec: Close
[0m16:29:51.811319 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__m1f7x4ec, now MetricFlow_request_mf_rid__hodrh27h)
[0m16:29:51.811751 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__hodrh27h"
[0m16:29:51.812008 [debug] [MainThread]: On MetricFlow_request_mf_rid__hodrh27h: BEGIN
[0m16:29:51.812245 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:51.812623 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:51.812883 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__hodrh27h"
[0m16:29:51.813130 [debug] [MainThread]: On MetricFlow_request_mf_rid__hodrh27h: SELECT
  SUM(b.booking_value) AS booking_value
  , b.is_instant AS booking__is_instant
  , l.country AS listing__country_latest
FROM *****.fct_bookings b
LEFT OUTER JOIN *****.dim_listings_latest l
  ON b.listing_id = l.listing_id
GROUP BY
  b.is_instant
  , l.country
[0m16:29:51.814241 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:51.815419 [debug] [MainThread]: On MetricFlow_request_mf_rid__hodrh27h: ROLLBACK
[0m16:29:51.815814 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__hodrh27h'
[0m16:29:51.816070 [debug] [MainThread]: On MetricFlow_request_mf_rid__hodrh27h: Close
[0m16:29:51.974183 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__hodrh27h, now MetricFlow_request_mf_rid__3w57uarv)
[0m16:29:51.974608 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__3w57uarv"
[0m16:29:51.974859 [debug] [MainThread]: On MetricFlow_request_mf_rid__3w57uarv: BEGIN
[0m16:29:51.975092 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:51.975466 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:51.975696 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__3w57uarv"
[0m16:29:51.975956 [debug] [MainThread]: On MetricFlow_request_mf_rid__3w57uarv: -- Join Standard Outputs
-- Pass Only Elements: ['bookings', 'booking__is_instant', 'listing__country_latest', 'booking__dt__day']
-- Aggregate Measures
-- Compute Metrics via Expressions
SELECT
  subq_5.booking__dt__day AS booking__dt__day
  , subq_5.booking__is_instant AS booking__is_instant
  , listings_latest_src_10000.country AS listing__country_latest
  , SUM(subq_5.bookings) AS bookings
FROM (
  -- Read Elements From Semantic Model 'bookings_source'
  -- Metric Time Dimension 'dt'
  -- Constrain Time Range to [2020-01-01T00:00:00, 2020-01-01T00:00:00]
  -- Pass Only Elements: ['bookings', 'booking__is_instant', 'booking__dt__day', 'listing']
  SELECT
    DATE_TRUNC('day', dt) AS booking__dt__day
    , listing_id AS listing
    , is_instant AS booking__is_instant
    , 1 AS bookings
  FROM *****.fct_bookings_dt bookings_source_src_10000
  WHERE DATE_TRUNC('day', dt) BETWEEN '2020-01-01' AND '2020-01-01'
) subq_5
LEFT OUTER JOIN
  *****.dim_listings_latest listings_latest_src_10000
ON
  subq_5.listing = listings_latest_src_10000.listing_id
GROUP BY
  subq_5.booking__dt__day
  , subq_5.booking__is_instant
  , listings_latest_src_10000.country
[0m16:29:51.977153 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:51.978060 [debug] [MainThread]: On MetricFlow_request_mf_rid__3w57uarv: ROLLBACK
[0m16:29:51.978370 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__3w57uarv'
[0m16:29:51.978601 [debug] [MainThread]: On MetricFlow_request_mf_rid__3w57uarv: Close
[0m16:29:51.980484 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__3w57uarv, now MetricFlow_request_mf_rid__nhx8l3k5)
[0m16:29:51.980775 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__nhx8l3k5"
[0m16:29:51.981013 [debug] [MainThread]: On MetricFlow_request_mf_rid__nhx8l3k5: BEGIN
[0m16:29:51.981238 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:51.981556 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:51.981783 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__nhx8l3k5"
[0m16:29:51.982017 [debug] [MainThread]: On MetricFlow_request_mf_rid__nhx8l3k5: SELECT
  SUM(1) AS bookings
  , b.is_instant AS booking__is_instant
  , l.country AS listing__country_latest
  , b.dt AS booking__dt__day
FROM *****.fct_bookings_dt b
LEFT OUTER JOIN *****.dim_listings_latest l
  ON b.listing_id = l.listing_id
WHERE dt BETWEEN CAST('2020-01-01' AS TIMESTAMP) AND CAST('2020-01-01' AS TIMESTAMP)
GROUP BY
  b.is_instant
  , b.dt
  , l.country
[0m16:29:51.984945 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:51.986681 [debug] [MainThread]: On MetricFlow_request_mf_rid__nhx8l3k5: ROLLBACK
[0m16:29:51.987079 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__nhx8l3k5'
[0m16:29:51.987325 [debug] [MainThread]: On MetricFlow_request_mf_rid__nhx8l3k5: Close
[0m16:29:53.370096 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__nhx8l3k5, now MetricFlow_request_mf_rid__0irh2zk1)
[0m16:29:53.370563 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__0irh2zk1"
[0m16:29:53.370821 [debug] [MainThread]: On MetricFlow_request_mf_rid__0irh2zk1: BEGIN
[0m16:29:53.371055 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:53.371441 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:53.371676 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__0irh2zk1"
[0m16:29:53.371904 [debug] [MainThread]: On MetricFlow_request_mf_rid__0irh2zk1: DROP TABLE IF EXISTS *****.test_table_a4uuvhx6
[0m16:29:53.372232 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:53.373044 [debug] [MainThread]: On MetricFlow_request_mf_rid__0irh2zk1: COMMIT
[0m16:29:53.373496 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__0irh2zk1"
[0m16:29:53.373884 [debug] [MainThread]: On MetricFlow_request_mf_rid__0irh2zk1: COMMIT
[0m16:29:53.374892 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:53.375274 [debug] [MainThread]: On MetricFlow_request_mf_rid__0irh2zk1: Close
[0m16:29:53.375611 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__0irh2zk1, now MetricFlow_request_mf_rid__rn6mxvi7)
[0m16:29:53.375871 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__rn6mxvi7"
[0m16:29:53.377339 [debug] [MainThread]: On MetricFlow_request_mf_rid__rn6mxvi7: BEGIN
[0m16:29:53.377602 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:53.377960 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:53.378199 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__rn6mxvi7"
[0m16:29:53.378446 [debug] [MainThread]: On MetricFlow_request_mf_rid__rn6mxvi7: CREATE TABLE *****.test_table_a4uuvhx6 AS (
  -- Aggregate Measures
  -- Compute Metrics via Expressions
  SELECT
    metric_time__day
    , SUM(bookings) AS bookings
  FROM (
    -- Read Elements From Semantic Model 'bookings_source'
    -- Metric Time Dimension 'ds'
    -- Pass Only Elements: ['bookings', 'metric_time__day']
    SELECT
      DATE_TRUNC('day', ds) AS metric_time__day
      , 1 AS bookings
    FROM *****.fct_bookings bookings_source_src_10000
  ) subq_2
  GROUP BY
    metric_time__day
)
[0m16:29:53.379669 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:53.382459 [debug] [MainThread]: On MetricFlow_request_mf_rid__rn6mxvi7: COMMIT
[0m16:29:53.383370 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__rn6mxvi7"
[0m16:29:53.384029 [debug] [MainThread]: On MetricFlow_request_mf_rid__rn6mxvi7: COMMIT
[0m16:29:53.385115 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:53.386028 [debug] [MainThread]: On MetricFlow_request_mf_rid__rn6mxvi7: Close
[0m16:29:53.388078 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__rn6mxvi7, now MetricFlow_request_mf_rid__98mwlzkl)
[0m16:29:53.388441 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__98mwlzkl"
[0m16:29:53.388691 [debug] [MainThread]: On MetricFlow_request_mf_rid__98mwlzkl: BEGIN
[0m16:29:53.388924 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:53.389272 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:53.389504 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__98mwlzkl"
[0m16:29:53.389747 [debug] [MainThread]: On MetricFlow_request_mf_rid__98mwlzkl: SELECT
  SUM(1) AS bookings
  , ds AS metric_time__day
FROM *****.fct_bookings
GROUP BY ds

[0m16:29:53.391055 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:53.392156 [debug] [MainThread]: On MetricFlow_request_mf_rid__98mwlzkl: ROLLBACK
[0m16:29:53.392571 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__98mwlzkl'
[0m16:29:53.392819 [debug] [MainThread]: On MetricFlow_request_mf_rid__98mwlzkl: Close
[0m16:29:53.393589 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__98mwlzkl, now MetricFlow_request_mf_rid__nal8ewb8)
[0m16:29:53.393881 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__nal8ewb8"
[0m16:29:53.394120 [debug] [MainThread]: On MetricFlow_request_mf_rid__nal8ewb8: BEGIN
[0m16:29:53.394346 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:53.394683 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:53.394913 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__nal8ewb8"
[0m16:29:53.395140 [debug] [MainThread]: On MetricFlow_request_mf_rid__nal8ewb8: SELECT
  bookings
  , metric_time__day
FROM *****.test_table_a4uuvhx6

[0m16:29:53.395538 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:53.397659 [debug] [MainThread]: On MetricFlow_request_mf_rid__nal8ewb8: ROLLBACK
[0m16:29:53.398078 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__nal8ewb8'
[0m16:29:53.398323 [debug] [MainThread]: On MetricFlow_request_mf_rid__nal8ewb8: Close
[0m16:29:53.401818 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__nal8ewb8, now MetricFlow_request_mf_rid__sucemt63)
[0m16:29:53.402155 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__sucemt63"
[0m16:29:53.402402 [debug] [MainThread]: On MetricFlow_request_mf_rid__sucemt63: BEGIN
[0m16:29:53.402632 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:53.402980 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:53.403214 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__sucemt63"
[0m16:29:53.403443 [debug] [MainThread]: On MetricFlow_request_mf_rid__sucemt63: DROP TABLE IF EXISTS *****.test_table_a4uuvhx6
[0m16:29:53.403752 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:53.405234 [debug] [MainThread]: On MetricFlow_request_mf_rid__sucemt63: COMMIT
[0m16:29:53.406095 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__sucemt63"
[0m16:29:53.410205 [debug] [MainThread]: On MetricFlow_request_mf_rid__sucemt63: COMMIT
[0m16:29:53.411739 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:53.412110 [debug] [MainThread]: On MetricFlow_request_mf_rid__sucemt63: Close
[0m16:29:53.564294 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__sucemt63, now MetricFlow_request_mf_rid__fe67ua6d)
[0m16:29:53.564748 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__fe67ua6d"
[0m16:29:53.565012 [debug] [MainThread]: On MetricFlow_request_mf_rid__fe67ua6d: BEGIN
[0m16:29:53.565250 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:53.565649 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:53.565915 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__fe67ua6d"
[0m16:29:53.566187 [debug] [MainThread]: On MetricFlow_request_mf_rid__fe67ua6d: -- Join Self Over Time Range
-- Pass Only Elements: ['txn_revenue', 'metric_time__day']
-- Constrain Time Range to [2020-02-01T00:00:00, 2020-04-30T00:00:00]
-- Aggregate Measures
-- Compute Metrics via Expressions
-- Order By ['metric_time__day']
SELECT
  subq_5.metric_time__day AS metric_time__day
  , SUM(subq_4.txn_revenue) AS trailing_2_months_revenue
FROM (
  -- Time Spine
  SELECT
    ds AS metric_time__day
  FROM *****.mf_time_spine subq_6
  WHERE ds BETWEEN '2020-02-01' AND '2020-04-30'
) subq_5
INNER JOIN (
  -- Read Elements From Semantic Model 'revenue'
  -- Metric Time Dimension 'ds'
  -- Constrain Time Range to [2019-12-01T00:00:00, 2020-04-30T00:00:00]
  SELECT
    DATE_TRUNC('day', created_at) AS metric_time__day
    , revenue AS txn_revenue
  FROM *****.fct_revenue revenue_src_10000
  WHERE DATE_TRUNC('day', created_at) BETWEEN '2019-12-01' AND '2020-04-30'
) subq_4
ON
  (
    subq_4.metric_time__day <= subq_5.metric_time__day
  ) AND (
    subq_4.metric_time__day > subq_5.metric_time__day - INTERVAL 2 month
  )
WHERE subq_5.metric_time__day BETWEEN '2020-02-01' AND '2020-04-30'
GROUP BY
  subq_5.metric_time__day
ORDER BY metric_time__day
[0m16:29:53.567593 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:53.569883 [debug] [MainThread]: On MetricFlow_request_mf_rid__fe67ua6d: ROLLBACK
[0m16:29:53.570324 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__fe67ua6d'
[0m16:29:53.570580 [debug] [MainThread]: On MetricFlow_request_mf_rid__fe67ua6d: Close
[0m16:29:53.859332 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__fe67ua6d, now MetricFlow_request_mf_rid__mbncrxmb)
[0m16:29:53.859760 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__mbncrxmb"
[0m16:29:53.860023 [debug] [MainThread]: On MetricFlow_request_mf_rid__mbncrxmb: BEGIN
[0m16:29:53.860253 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:53.860618 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:53.860847 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__mbncrxmb"
[0m16:29:53.861157 [debug] [MainThread]: On MetricFlow_request_mf_rid__mbncrxmb: -- Combine Aggregated Outputs
-- Order By ['metric_time__day']
SELECT
  COALESCE(subq_13.metric_time__day, subq_23.metric_time__day) AS metric_time__day
  , MAX(subq_13.revenue_all_time) AS revenue_all_time
  , MAX(subq_23.trailing_2_months_revenue) AS trailing_2_months_revenue
FROM (
  -- Join Self Over Time Range
  -- Pass Only Elements: ['txn_revenue', 'metric_time__day']
  -- Constrain Time Range to [2020-03-31T00:00:00, 2020-05-31T00:00:00]
  -- Aggregate Measures
  -- Compute Metrics via Expressions
  SELECT
    subq_7.metric_time__day AS metric_time__day
    , SUM(subq_6.txn_revenue) AS revenue_all_time
  FROM (
    -- Time Spine
    SELECT
      ds AS metric_time__day
    FROM *****.mf_time_spine subq_8
    WHERE ds BETWEEN '2020-03-31' AND '2020-05-31'
  ) subq_7
  INNER JOIN (
    -- Read Elements From Semantic Model 'revenue'
    -- Metric Time Dimension 'ds'
    -- Constrain Time Range to [2000-01-01T00:00:00, 2020-05-31T00:00:00]
    SELECT
      DATE_TRUNC('day', created_at) AS metric_time__day
      , revenue AS txn_revenue
    FROM *****.fct_revenue revenue_src_10000
    WHERE DATE_TRUNC('day', created_at) BETWEEN '2000-01-01' AND '2020-05-31'
  ) subq_6
  ON
    (subq_6.metric_time__day <= subq_7.metric_time__day)
  WHERE subq_7.metric_time__day BETWEEN '2020-03-31' AND '2020-05-31'
  GROUP BY
    subq_7.metric_time__day
) subq_13
FULL OUTER JOIN (
  -- Join Self Over Time Range
  -- Pass Only Elements: ['txn_revenue', 'metric_time__day']
  -- Constrain Time Range to [2020-03-31T00:00:00, 2020-05-31T00:00:00]
  -- Aggregate Measures
  -- Compute Metrics via Expressions
  SELECT
    subq_17.metric_time__day AS metric_time__day
    , SUM(subq_16.txn_revenue) AS trailing_2_months_revenue
  FROM (
    -- Time Spine
    SELECT
      ds AS metric_time__day
    FROM *****.mf_time_spine subq_18
    WHERE ds BETWEEN '2020-03-31' AND '2020-05-31'
  ) subq_17
  INNER JOIN (
    -- Read Elements From Semantic Model 'revenue'
    -- Metric Time Dimension 'ds'
    -- Constrain Time Range to [2020-01-29T00:00:00, 2020-05-31T00:00:00]
    SELECT
      DATE_TRUNC('day', created_at) AS metric_time__day
      , revenue AS txn_revenue
    FROM *****.fct_revenue revenue_src_10000
    WHERE DATE_TRUNC('day', created_at) BETWEEN '2020-01-29' AND '2020-05-31'
  ) subq_16
  ON
    (
      subq_16.metric_time__day <= subq_17.metric_time__day
    ) AND (
      subq_16.metric_time__day > subq_17.metric_time__day - INTERVAL 2 month
    )
  WHERE subq_17.metric_time__day BETWEEN '2020-03-31' AND '2020-05-31'
  GROUP BY
    subq_17.metric_time__day
) subq_23
ON
  subq_13.metric_time__day = subq_23.metric_time__day
GROUP BY
  COALESCE(subq_13.metric_time__day, subq_23.metric_time__day)
ORDER BY metric_time__day
[0m16:29:53.864940 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:53.868149 [debug] [MainThread]: On MetricFlow_request_mf_rid__mbncrxmb: ROLLBACK
[0m16:29:53.868536 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__mbncrxmb'
[0m16:29:53.868782 [debug] [MainThread]: On MetricFlow_request_mf_rid__mbncrxmb: Close
[0m16:29:54.057626 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__mbncrxmb, now MetricFlow_request_mf_rid__dnev3krw)
[0m16:29:54.058063 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__dnev3krw"
[0m16:29:54.058320 [debug] [MainThread]: On MetricFlow_request_mf_rid__dnev3krw: BEGIN
[0m16:29:54.058553 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:54.058929 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:54.059160 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__dnev3krw"
[0m16:29:54.059425 [debug] [MainThread]: On MetricFlow_request_mf_rid__dnev3krw: -- Join Self Over Time Range
-- Pass Only Elements: ['bookers', 'metric_time__day']
-- Constrain Time Range to [2019-12-31T00:00:00, 2020-01-03T00:00:00]
-- Aggregate Measures
-- Compute Metrics via Expressions
-- Order By ['metric_time__day']
SELECT
  subq_5.metric_time__day AS metric_time__day
  , COUNT(DISTINCT subq_4.bookers) AS every_two_days_bookers
FROM (
  -- Time Spine
  SELECT
    ds AS metric_time__day
  FROM *****.mf_time_spine subq_6
  WHERE ds BETWEEN '2019-12-31' AND '2020-01-03'
) subq_5
INNER JOIN (
  -- Read Elements From Semantic Model 'bookings_source'
  -- Metric Time Dimension 'ds'
  -- Constrain Time Range to [2019-12-29T00:00:00, 2020-01-03T00:00:00]
  SELECT
    DATE_TRUNC('day', ds) AS metric_time__day
    , guest_id AS bookers
  FROM *****.fct_bookings bookings_source_src_10000
  WHERE DATE_TRUNC('day', ds) BETWEEN '2019-12-29' AND '2020-01-03'
) subq_4
ON
  (
    subq_4.metric_time__day <= subq_5.metric_time__day
  ) AND (
    subq_4.metric_time__day > subq_5.metric_time__day - INTERVAL 2 day
  )
WHERE subq_5.metric_time__day BETWEEN '2019-12-31' AND '2020-01-03'
GROUP BY
  subq_5.metric_time__day
ORDER BY metric_time__day
[0m16:29:54.062195 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:54.063272 [debug] [MainThread]: On MetricFlow_request_mf_rid__dnev3krw: ROLLBACK
[0m16:29:54.063633 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__dnev3krw'
[0m16:29:54.063884 [debug] [MainThread]: On MetricFlow_request_mf_rid__dnev3krw: Close
[0m16:29:54.359964 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__dnev3krw, now MetricFlow_request_mf_rid__s8z3tlxw)
[0m16:29:54.360387 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__s8z3tlxw"
[0m16:29:54.360639 [debug] [MainThread]: On MetricFlow_request_mf_rid__s8z3tlxw: BEGIN
[0m16:29:54.360869 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:54.361228 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:54.361459 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__s8z3tlxw"
[0m16:29:54.361714 [debug] [MainThread]: On MetricFlow_request_mf_rid__s8z3tlxw: -- Join Self Over Time Range
-- Pass Only Elements: ['txn_revenue', 'metric_time__day']
-- Constrain Time Range to [2021-01-03T00:00:00, 2021-01-06T00:00:00]
-- Aggregate Measures
-- Compute Metrics via Expressions
-- Order By ['metric_time__day']
SELECT
  subq_5.metric_time__day AS metric_time__day
  , SUM(subq_4.txn_revenue) AS revenue_mtd
FROM (
  -- Time Spine
  SELECT
    ds AS metric_time__day
  FROM *****.mf_time_spine subq_6
  WHERE ds BETWEEN '2021-01-03' AND '2021-01-06'
) subq_5
INNER JOIN (
  -- Read Elements From Semantic Model 'revenue'
  -- Metric Time Dimension 'ds'
  -- Constrain Time Range to [2020-12-03T00:00:00, 2021-01-06T00:00:00]
  SELECT
    DATE_TRUNC('day', created_at) AS metric_time__day
    , revenue AS txn_revenue
  FROM *****.fct_revenue revenue_src_10000
  WHERE DATE_TRUNC('day', created_at) BETWEEN '2020-12-03' AND '2021-01-06'
) subq_4
ON
  (
    subq_4.metric_time__day <= subq_5.metric_time__day
  ) AND (
    subq_4.metric_time__day >= DATE_TRUNC('month', subq_5.metric_time__day)
  )
WHERE subq_5.metric_time__day BETWEEN '2021-01-03' AND '2021-01-06'
GROUP BY
  subq_5.metric_time__day
ORDER BY metric_time__day
[0m16:29:54.365422 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:54.367922 [debug] [MainThread]: On MetricFlow_request_mf_rid__s8z3tlxw: ROLLBACK
[0m16:29:54.369986 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__s8z3tlxw'
[0m16:29:54.370380 [debug] [MainThread]: On MetricFlow_request_mf_rid__s8z3tlxw: Close
[0m16:29:54.568673 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__s8z3tlxw, now MetricFlow_request_mf_rid__erv26oa5)
[0m16:29:54.569095 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__erv26oa5"
[0m16:29:54.569353 [debug] [MainThread]: On MetricFlow_request_mf_rid__erv26oa5: BEGIN
[0m16:29:54.569589 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:54.569963 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:54.570195 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__erv26oa5"
[0m16:29:54.570467 [debug] [MainThread]: On MetricFlow_request_mf_rid__erv26oa5: -- Constrain Output with WHERE
-- Aggregate Measures
-- Compute Metrics via Expressions
-- Order By ['metric_time__day']
SELECT
  metric_time__day
  , SUM(txn_revenue) AS trailing_2_months_revenue
FROM (
  -- Join Self Over Time Range
  -- Pass Only Elements: ['txn_revenue', 'metric_time__day']
  -- Constrain Time Range to [2000-01-01T00:00:00, 2020-12-31T00:00:00]
  SELECT
    subq_5.metric_time__day AS metric_time__day
    , subq_4.txn_revenue AS txn_revenue
  FROM (
    -- Time Spine
    SELECT
      ds AS metric_time__day
    FROM *****.mf_time_spine subq_6
    WHERE ds BETWEEN '2000-01-01' AND '2020-12-31'
  ) subq_5
  INNER JOIN (
    -- Read Elements From Semantic Model 'revenue'
    -- Metric Time Dimension 'ds'
    -- Constrain Time Range to [1999-11-01T00:00:00, 2020-12-31T00:00:00]
    SELECT
      DATE_TRUNC('day', created_at) AS metric_time__day
      , revenue AS txn_revenue
    FROM *****.fct_revenue revenue_src_10000
    WHERE DATE_TRUNC('day', created_at) BETWEEN '1999-11-01' AND '2020-12-31'
  ) subq_4
  ON
    (
      subq_4.metric_time__day <= subq_5.metric_time__day
    ) AND (
      subq_4.metric_time__day > subq_5.metric_time__day - INTERVAL 2 month
    )
  WHERE subq_5.metric_time__day BETWEEN '2000-01-01' AND '2020-12-31'
) subq_9
WHERE metric_time__day = CAST('2020-03-15' AS TIMESTAMP) or metric_time__day = CAST('2020-04-30' AS TIMESTAMP)
GROUP BY
  metric_time__day
ORDER BY metric_time__day
[0m16:29:54.571820 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:54.572723 [debug] [MainThread]: On MetricFlow_request_mf_rid__erv26oa5: ROLLBACK
[0m16:29:54.573044 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__erv26oa5'
[0m16:29:54.573282 [debug] [MainThread]: On MetricFlow_request_mf_rid__erv26oa5: Close
[0m16:29:54.977599 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__erv26oa5, now MetricFlow_request_mf_rid__bvmtnkvm)
[0m16:29:54.978004 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__bvmtnkvm"
[0m16:29:54.978255 [debug] [MainThread]: On MetricFlow_request_mf_rid__bvmtnkvm: BEGIN
[0m16:29:54.978491 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:54.978855 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:54.979088 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__bvmtnkvm"
[0m16:29:54.979354 [debug] [MainThread]: On MetricFlow_request_mf_rid__bvmtnkvm: -- Compute Metrics via Expressions
-- Order By ['metric_time__day']
SELECT
  metric_time__day
  , COALESCE(bookings, 0) AS bookings_fill_nulls_with_0
FROM (
  -- Join to Time Spine Dataset
  -- Constrain Time Range to [2019-11-27T00:00:00, 2020-01-05T00:00:00]
  SELECT
    subq_7.metric_time__day AS metric_time__day
    , subq_6.bookings AS bookings
  FROM (
    -- Time Spine
    SELECT
      ds AS metric_time__day
    FROM *****.mf_time_spine subq_8
    WHERE ds BETWEEN '2019-11-27' AND '2020-01-05'
  ) subq_7
  LEFT OUTER JOIN (
    -- Aggregate Measures
    SELECT
      metric_time__day
      , SUM(bookings) AS bookings
    FROM (
      -- Read Elements From Semantic Model 'bookings_source'
      -- Metric Time Dimension 'ds'
      -- Constrain Time Range to [2019-11-27T00:00:00, 2020-01-05T00:00:00]
      -- Pass Only Elements: ['bookings', 'metric_time__day']
      SELECT
        DATE_TRUNC('day', ds) AS metric_time__day
        , 1 AS bookings
      FROM *****.fct_bookings bookings_source_src_10000
      WHERE DATE_TRUNC('day', ds) BETWEEN '2019-11-27' AND '2020-01-05'
    ) subq_5
    GROUP BY
      metric_time__day
  ) subq_6
  ON
    subq_7.metric_time__day = subq_6.metric_time__day
  WHERE subq_7.metric_time__day BETWEEN '2019-11-27' AND '2020-01-05'
) subq_10
ORDER BY metric_time__day
[0m16:29:54.980305 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:54.981377 [debug] [MainThread]: On MetricFlow_request_mf_rid__bvmtnkvm: ROLLBACK
[0m16:29:54.981688 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__bvmtnkvm'
[0m16:29:54.981915 [debug] [MainThread]: On MetricFlow_request_mf_rid__bvmtnkvm: Close
[0m16:29:55.281912 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__bvmtnkvm, now MetricFlow_request_mf_rid__rsaao0id)
[0m16:29:55.282327 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__rsaao0id"
[0m16:29:55.282585 [debug] [MainThread]: On MetricFlow_request_mf_rid__rsaao0id: BEGIN
[0m16:29:55.282819 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:55.283207 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:55.283438 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__rsaao0id"
[0m16:29:55.283707 [debug] [MainThread]: On MetricFlow_request_mf_rid__rsaao0id: -- Compute Metrics via Expressions
-- Order By ['metric_time__month']
SELECT
  metric_time__month
  , COALESCE(bookings, 0) AS bookings_fill_nulls_with_0
FROM (
  -- Join to Time Spine Dataset
  -- Constrain Time Range to [2019-01-01T00:00:00, 2020-12-31T00:00:00]
  SELECT
    subq_7.metric_time__month AS metric_time__month
    , subq_6.bookings AS bookings
  FROM (
    -- Time Spine
    SELECT
      DATE_TRUNC('month', ds) AS metric_time__month
    FROM *****.mf_time_spine subq_8
    WHERE ds BETWEEN '2019-01-01' AND '2020-12-31'
    GROUP BY
      DATE_TRUNC('month', ds)
  ) subq_7
  LEFT OUTER JOIN (
    -- Aggregate Measures
    SELECT
      metric_time__month
      , SUM(bookings) AS bookings
    FROM (
      -- Read Elements From Semantic Model 'bookings_source'
      -- Metric Time Dimension 'ds'
      -- Constrain Time Range to [2019-01-01T00:00:00, 2020-12-31T00:00:00]
      -- Pass Only Elements: ['bookings', 'metric_time__month']
      SELECT
        DATE_TRUNC('month', ds) AS metric_time__month
        , 1 AS bookings
      FROM *****.fct_bookings bookings_source_src_10000
      WHERE DATE_TRUNC('day', ds) BETWEEN '2019-01-01' AND '2020-12-31'
    ) subq_5
    GROUP BY
      metric_time__month
  ) subq_6
  ON
    subq_7.metric_time__month = subq_6.metric_time__month
  WHERE subq_7.metric_time__month BETWEEN '2019-01-01' AND '2020-12-31'
) subq_10
ORDER BY metric_time__month
[0m16:29:55.285044 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:55.288105 [debug] [MainThread]: On MetricFlow_request_mf_rid__rsaao0id: ROLLBACK
[0m16:29:55.289216 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__rsaao0id'
[0m16:29:55.289915 [debug] [MainThread]: On MetricFlow_request_mf_rid__rsaao0id: Close
[0m16:29:55.564543 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__rsaao0id, now MetricFlow_request_mf_rid__okwm7x7v)
[0m16:29:55.564967 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__okwm7x7v"
[0m16:29:55.565222 [debug] [MainThread]: On MetricFlow_request_mf_rid__okwm7x7v: BEGIN
[0m16:29:55.565455 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:55.565818 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:55.566046 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__okwm7x7v"
[0m16:29:55.566303 [debug] [MainThread]: On MetricFlow_request_mf_rid__okwm7x7v: -- Join to Time Spine Dataset
-- Constrain Time Range to [2019-11-27T00:00:00, 2020-01-05T00:00:00]
-- Compute Metrics via Expressions
-- Order By ['metric_time__day']
SELECT
  subq_7.metric_time__day AS metric_time__day
  , subq_6.bookings AS bookings_join_to_time_spine
FROM (
  -- Time Spine
  SELECT
    ds AS metric_time__day
  FROM *****.mf_time_spine subq_8
  WHERE ds BETWEEN '2019-11-27' AND '2020-01-05'
) subq_7
LEFT OUTER JOIN (
  -- Aggregate Measures
  SELECT
    metric_time__day
    , SUM(bookings) AS bookings
  FROM (
    -- Read Elements From Semantic Model 'bookings_source'
    -- Metric Time Dimension 'ds'
    -- Constrain Time Range to [2019-11-27T00:00:00, 2020-01-05T00:00:00]
    -- Pass Only Elements: ['bookings', 'metric_time__day']
    SELECT
      DATE_TRUNC('day', ds) AS metric_time__day
      , 1 AS bookings
    FROM *****.fct_bookings bookings_source_src_10000
    WHERE DATE_TRUNC('day', ds) BETWEEN '2019-11-27' AND '2020-01-05'
  ) subq_5
  GROUP BY
    metric_time__day
) subq_6
ON
  subq_7.metric_time__day = subq_6.metric_time__day
WHERE subq_7.metric_time__day BETWEEN '2019-11-27' AND '2020-01-05'
ORDER BY metric_time__day
[0m16:29:55.567789 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:55.571635 [debug] [MainThread]: On MetricFlow_request_mf_rid__okwm7x7v: ROLLBACK
[0m16:29:55.572087 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__okwm7x7v'
[0m16:29:55.572341 [debug] [MainThread]: On MetricFlow_request_mf_rid__okwm7x7v: Close
[0m16:29:56.045716 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__okwm7x7v, now MetricFlow_request_mf_rid__v6cmml53)
[0m16:29:56.046168 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__v6cmml53"
[0m16:29:56.046421 [debug] [MainThread]: On MetricFlow_request_mf_rid__v6cmml53: BEGIN
[0m16:29:56.046653 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:56.047012 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:56.047242 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__v6cmml53"
[0m16:29:56.047535 [debug] [MainThread]: On MetricFlow_request_mf_rid__v6cmml53: -- Combine Aggregated Outputs
-- Order By ['metric_time__day']
SELECT
  COALESCE(subq_13.metric_time__day, subq_19.metric_time__day) AS metric_time__day
  , COALESCE(MAX(subq_13.bookings_fill_nulls_with_0), 0) AS bookings_fill_nulls_with_0
  , MAX(subq_19.views) AS views
FROM (
  -- Compute Metrics via Expressions
  SELECT
    metric_time__day
    , COALESCE(bookings, 0) AS bookings_fill_nulls_with_0
  FROM (
    -- Join to Time Spine Dataset
    -- Constrain Time Range to [2019-11-27T00:00:00, 2020-01-05T00:00:00]
    SELECT
      subq_9.metric_time__day AS metric_time__day
      , subq_8.bookings AS bookings
    FROM (
      -- Time Spine
      SELECT
        ds AS metric_time__day
      FROM *****.mf_time_spine subq_10
      WHERE ds BETWEEN '2019-11-27' AND '2020-01-05'
    ) subq_9
    LEFT OUTER JOIN (
      -- Aggregate Measures
      SELECT
        metric_time__day
        , SUM(bookings) AS bookings
      FROM (
        -- Read Elements From Semantic Model 'bookings_source'
        -- Metric Time Dimension 'ds'
        -- Constrain Time Range to [2019-11-27T00:00:00, 2020-01-05T00:00:00]
        -- Pass Only Elements: ['bookings', 'metric_time__day']
        SELECT
          DATE_TRUNC('day', ds) AS metric_time__day
          , 1 AS bookings
        FROM *****.fct_bookings bookings_source_src_10000
        WHERE DATE_TRUNC('day', ds) BETWEEN '2019-11-27' AND '2020-01-05'
      ) subq_7
      GROUP BY
        metric_time__day
    ) subq_8
    ON
      subq_9.metric_time__day = subq_8.metric_time__day
    WHERE subq_9.metric_time__day BETWEEN '2019-11-27' AND '2020-01-05'
  ) subq_12
) subq_13
FULL OUTER JOIN (
  -- Aggregate Measures
  -- Compute Metrics via Expressions
  SELECT
    metric_time__day
    , SUM(views) AS views
  FROM (
    -- Read Elements From Semantic Model 'views_source'
    -- Metric Time Dimension 'ds'
    -- Constrain Time Range to [2019-11-27T00:00:00, 2020-01-05T00:00:00]
    -- Pass Only Elements: ['views', 'metric_time__day']
    SELECT
      DATE_TRUNC('day', ds) AS metric_time__day
      , 1 AS views
    FROM *****.fct_views views_source_src_10000
    WHERE DATE_TRUNC('day', ds) BETWEEN '2019-11-27' AND '2020-01-05'
  ) subq_17
  GROUP BY
    metric_time__day
) subq_19
ON
  subq_13.metric_time__day = subq_19.metric_time__day
GROUP BY
  COALESCE(subq_13.metric_time__day, subq_19.metric_time__day)
ORDER BY metric_time__day
[0m16:29:56.049083 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:56.050296 [debug] [MainThread]: On MetricFlow_request_mf_rid__v6cmml53: ROLLBACK
[0m16:29:56.050604 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__v6cmml53'
[0m16:29:56.050831 [debug] [MainThread]: On MetricFlow_request_mf_rid__v6cmml53: Close
[0m16:29:58.322416 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__v6cmml53, now MetricFlow_request_mf_rid__7tnks0k7)
[0m16:29:58.322849 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__7tnks0k7"
[0m16:29:58.323114 [debug] [MainThread]: On MetricFlow_request_mf_rid__7tnks0k7: BEGIN
[0m16:29:58.323358 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:58.323738 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:58.323978 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__7tnks0k7"
[0m16:29:58.324212 [debug] [MainThread]: On MetricFlow_request_mf_rid__7tnks0k7: DROP SCHEMA IF EXISTS ***** CASCADE
[0m16:29:58.324794 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:58.325374 [debug] [MainThread]: On MetricFlow_request_mf_rid__7tnks0k7: COMMIT
[0m16:29:58.325616 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__7tnks0k7"
[0m16:29:58.325842 [debug] [MainThread]: On MetricFlow_request_mf_rid__7tnks0k7: COMMIT
[0m16:29:58.326633 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:58.326881 [debug] [MainThread]: On MetricFlow_request_mf_rid__7tnks0k7: Close
