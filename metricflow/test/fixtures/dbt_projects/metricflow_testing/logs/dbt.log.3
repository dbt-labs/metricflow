[0m16:29:47.385574 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__f5aa5te1, now MetricFlow_request_mf_rid__czdc8s1v)
[0m16:29:47.386506 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__czdc8s1v"
[0m16:29:47.389090 [debug] [MainThread]: On MetricFlow_request_mf_rid__czdc8s1v: BEGIN
[0m16:29:47.391168 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:47.391517 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:47.391763 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__czdc8s1v"
[0m16:29:47.392008 [debug] [MainThread]: On MetricFlow_request_mf_rid__czdc8s1v: DROP TABLE IF EXISTS *****.test_table_8htt3l8z
[0m16:29:47.392363 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:47.392970 [debug] [MainThread]: On MetricFlow_request_mf_rid__czdc8s1v: COMMIT
[0m16:29:47.393224 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__czdc8s1v"
[0m16:29:47.393450 [debug] [MainThread]: On MetricFlow_request_mf_rid__czdc8s1v: COMMIT
[0m16:29:47.393708 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:47.393950 [debug] [MainThread]: On MetricFlow_request_mf_rid__czdc8s1v: Close
[0m16:29:47.394249 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__czdc8s1v, now MetricFlow_request_mf_rid__i3ca6bxu)
[0m16:29:47.394493 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__i3ca6bxu"
[0m16:29:47.394720 [debug] [MainThread]: On MetricFlow_request_mf_rid__i3ca6bxu: BEGIN
[0m16:29:47.394937 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:47.395634 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:47.395935 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__i3ca6bxu"
[0m16:29:47.396207 [debug] [MainThread]: On MetricFlow_request_mf_rid__i3ca6bxu: CREATE TABLE *****.test_table_8htt3l8z AS (
  -- Aggregate Measures
  -- Compute Metrics via Expressions
  -- Order By [] Limit 2
  SELECT
    metric_time__day
    , SUM(bookings) AS bookings
  FROM (
    -- Read Elements From Semantic Model 'bookings_source'
    -- Metric Time Dimension 'ds'
    -- Constrain Time Range to [2019-01-01T00:00:00, 2024-01-01T00:00:00]
    -- Pass Only Elements: ['bookings', 'metric_time__day']
    SELECT
      DATE_TRUNC('day', ds) AS metric_time__day
      , 1 AS bookings
    FROM *****.fct_bookings bookings_source_src_10000
    WHERE DATE_TRUNC('day', ds) BETWEEN '2019-01-01' AND '2024-01-01'
  ) subq_5
  GROUP BY
    metric_time__day
  LIMIT 2
)
[0m16:29:47.396922 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:47.397508 [debug] [MainThread]: On MetricFlow_request_mf_rid__i3ca6bxu: COMMIT
[0m16:29:47.397761 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__i3ca6bxu"
[0m16:29:47.397996 [debug] [MainThread]: On MetricFlow_request_mf_rid__i3ca6bxu: COMMIT
[0m16:29:47.398296 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:47.398537 [debug] [MainThread]: On MetricFlow_request_mf_rid__i3ca6bxu: Close
[0m16:29:51.079844 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__i3ca6bxu, now MetricFlow_request_mf_rid__it5nhola)
[0m16:29:51.080297 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__it5nhola"
[0m16:29:51.080569 [debug] [MainThread]: On MetricFlow_request_mf_rid__it5nhola: BEGIN
[0m16:29:51.080814 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:51.081227 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:51.081485 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__it5nhola"
[0m16:29:51.081746 [debug] [MainThread]: On MetricFlow_request_mf_rid__it5nhola: -- Read Elements From Semantic Model 'bookings_source'
-- Metric Time Dimension 'ds'
-- Pass Only Elements: ['median_booking_value', 'metric_time__day']
-- Aggregate Measures
-- Compute Metrics via Expressions
SELECT
  DATE_TRUNC('day', ds) AS metric_time__day
  , PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY (booking_value)) AS median_booking_value
FROM *****.fct_bookings bookings_source_src_10000
GROUP BY
  DATE_TRUNC('day', ds)
[0m16:29:51.083019 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:51.084098 [debug] [MainThread]: On MetricFlow_request_mf_rid__it5nhola: ROLLBACK
[0m16:29:51.084455 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__it5nhola'
[0m16:29:51.084711 [debug] [MainThread]: On MetricFlow_request_mf_rid__it5nhola: Close
[0m16:29:51.086563 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__it5nhola, now MetricFlow_request_mf_rid__98d81z2l)
[0m16:29:51.086868 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__98d81z2l"
[0m16:29:51.087109 [debug] [MainThread]: On MetricFlow_request_mf_rid__98d81z2l: BEGIN
[0m16:29:51.087342 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:51.087685 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:51.087911 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__98d81z2l"
[0m16:29:51.088139 [debug] [MainThread]: On MetricFlow_request_mf_rid__98d81z2l: SELECT
  PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY (booking_value)) AS median_booking_value
  , ds AS metric_time__day
FROM *****.fct_bookings
GROUP BY
  ds
[0m16:29:51.088885 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:51.091492 [debug] [MainThread]: On MetricFlow_request_mf_rid__98d81z2l: ROLLBACK
[0m16:29:51.091916 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__98d81z2l'
[0m16:29:51.092173 [debug] [MainThread]: On MetricFlow_request_mf_rid__98d81z2l: Close
[0m16:29:51.541668 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__98d81z2l, now MetricFlow_request_mf_rid__zrn6ioa3)
[0m16:29:51.542090 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__zrn6ioa3"
[0m16:29:51.542346 [debug] [MainThread]: On MetricFlow_request_mf_rid__zrn6ioa3: BEGIN
[0m16:29:51.542598 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:51.542973 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:51.543205 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__zrn6ioa3"
[0m16:29:51.543485 [debug] [MainThread]: On MetricFlow_request_mf_rid__zrn6ioa3: -- Compute Metrics via Expressions
SELECT
  metric_time__day
  , CAST(average_booking_value AS DOUBLE) / CAST(NULLIF(max_booking_value, 0) AS DOUBLE) AS instant_booking_fraction_of_max_value
FROM (
  -- Combine Aggregated Outputs
  SELECT
    COALESCE(subq_6.metric_time__day, subq_11.metric_time__day) AS metric_time__day
    , MAX(subq_6.average_booking_value) AS average_booking_value
    , MAX(subq_11.max_booking_value) AS max_booking_value
  FROM (
    -- Constrain Output with WHERE
    -- Pass Only Elements: ['average_booking_value', 'metric_time__day']
    -- Aggregate Measures
    -- Compute Metrics via Expressions
    SELECT
      metric_time__day
      , AVG(average_booking_value) AS average_booking_value
    FROM (
      -- Read Elements From Semantic Model 'bookings_source'
      -- Metric Time Dimension 'ds'
      -- Pass Only Elements: ['average_booking_value', 'booking__is_instant', 'metric_time__day']
      SELECT
        DATE_TRUNC('day', ds) AS metric_time__day
        , is_instant AS booking__is_instant
        , booking_value AS average_booking_value
      FROM *****.fct_bookings bookings_source_src_10000
    ) subq_2
    WHERE booking__is_instant
    GROUP BY
      metric_time__day
  ) subq_6
  FULL OUTER JOIN (
    -- Read Elements From Semantic Model 'bookings_source'
    -- Metric Time Dimension 'ds'
    -- Pass Only Elements: ['max_booking_value', 'metric_time__day']
    -- Aggregate Measures
    -- Compute Metrics via Expressions
    SELECT
      DATE_TRUNC('day', ds) AS metric_time__day
      , MAX(booking_value) AS max_booking_value
    FROM *****.fct_bookings bookings_source_src_10000
    GROUP BY
      DATE_TRUNC('day', ds)
  ) subq_11
  ON
    subq_6.metric_time__day = subq_11.metric_time__day
  GROUP BY
    COALESCE(subq_6.metric_time__day, subq_11.metric_time__day)
) subq_12
[0m16:29:51.544879 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:51.545749 [debug] [MainThread]: On MetricFlow_request_mf_rid__zrn6ioa3: ROLLBACK
[0m16:29:51.546063 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__zrn6ioa3'
[0m16:29:51.546299 [debug] [MainThread]: On MetricFlow_request_mf_rid__zrn6ioa3: Close
[0m16:29:51.548032 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__zrn6ioa3, now MetricFlow_request_mf_rid__t4emv0ml)
[0m16:29:51.548391 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__t4emv0ml"
[0m16:29:51.548637 [debug] [MainThread]: On MetricFlow_request_mf_rid__t4emv0ml: BEGIN
[0m16:29:51.548866 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:51.549181 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:51.549419 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__t4emv0ml"
[0m16:29:51.550550 [debug] [MainThread]: On MetricFlow_request_mf_rid__t4emv0ml: SELECT
  a.average_booking_value / b.max_booking_value AS instant_booking_fraction_of_max_value
  , COALESCE(a.ds, b.ds) AS metric_time__day
FROM (
  SELECT
    CAST(AVG(booking_value) AS DOUBLE ) AS average_booking_value
    , ds
  FROM *****.fct_bookings
  WHERE is_instant
  GROUP BY ds
) a
FULL OUTER JOIN (
  SELECT
    CAST(NULLIF(MAX(booking_value), 0) AS DOUBLE ) AS max_booking_value
    , ds
  FROM *****.fct_bookings
  GROUP BY ds
) b
ON a.ds = b.ds
[0m16:29:51.555163 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:51.558439 [debug] [MainThread]: On MetricFlow_request_mf_rid__t4emv0ml: ROLLBACK
[0m16:29:51.558814 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__t4emv0ml'
[0m16:29:51.559065 [debug] [MainThread]: On MetricFlow_request_mf_rid__t4emv0ml: Close
[0m16:29:52.031244 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__t4emv0ml, now MetricFlow_request_mf_rid__buu0xnax)
[0m16:29:52.031664 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__buu0xnax"
[0m16:29:52.031918 [debug] [MainThread]: On MetricFlow_request_mf_rid__buu0xnax: BEGIN
[0m16:29:52.032148 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:52.032518 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:52.032751 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__buu0xnax"
[0m16:29:52.033041 [debug] [MainThread]: On MetricFlow_request_mf_rid__buu0xnax: -- Compute Metrics via Expressions
SELECT
  metric_time__day
  , CAST(average_booking_value AS DOUBLE) / CAST(NULLIF(max_booking_value, 0) AS DOUBLE) AS lux_booking_fraction_of_max_value
FROM (
  -- Combine Aggregated Outputs
  SELECT
    COALESCE(subq_11.metric_time__day, subq_16.metric_time__day) AS metric_time__day
    , MAX(subq_11.average_booking_value) AS average_booking_value
    , MAX(subq_16.max_booking_value) AS max_booking_value
  FROM (
    -- Constrain Output with WHERE
    -- Pass Only Elements: ['average_booking_value', 'metric_time__day']
    -- Aggregate Measures
    -- Compute Metrics via Expressions
    SELECT
      metric_time__day
      , AVG(average_booking_value) AS average_booking_value
    FROM (
      -- Join Standard Outputs
      -- Pass Only Elements: ['average_booking_value', 'listing__is_lux_latest', 'metric_time__day']
      SELECT
        DATE_TRUNC('day', bookings_source_src_10000.ds) AS metric_time__day
        , listings_latest_src_10000.is_lux AS listing__is_lux_latest
        , bookings_source_src_10000.booking_value AS average_booking_value
      FROM *****.fct_bookings bookings_source_src_10000
      LEFT OUTER JOIN
        *****.dim_listings_latest listings_latest_src_10000
      ON
        bookings_source_src_10000.listing_id = listings_latest_src_10000.listing_id
    ) subq_7
    WHERE listing__is_lux_latest
    GROUP BY
      metric_time__day
  ) subq_11
  FULL OUTER JOIN (
    -- Read Elements From Semantic Model 'bookings_source'
    -- Metric Time Dimension 'ds'
    -- Pass Only Elements: ['max_booking_value', 'metric_time__day']
    -- Aggregate Measures
    -- Compute Metrics via Expressions
    SELECT
      DATE_TRUNC('day', ds) AS metric_time__day
      , MAX(booking_value) AS max_booking_value
    FROM *****.fct_bookings bookings_source_src_10000
    GROUP BY
      DATE_TRUNC('day', ds)
  ) subq_16
  ON
    subq_11.metric_time__day = subq_16.metric_time__day
  GROUP BY
    COALESCE(subq_11.metric_time__day, subq_16.metric_time__day)
) subq_17
[0m16:29:52.035314 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:52.038082 [debug] [MainThread]: On MetricFlow_request_mf_rid__buu0xnax: ROLLBACK
[0m16:29:52.038981 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__buu0xnax'
[0m16:29:52.039751 [debug] [MainThread]: On MetricFlow_request_mf_rid__buu0xnax: Close
[0m16:29:52.046152 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__buu0xnax, now MetricFlow_request_mf_rid__19l2bevu)
[0m16:29:52.047220 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__19l2bevu"
[0m16:29:52.047814 [debug] [MainThread]: On MetricFlow_request_mf_rid__19l2bevu: BEGIN
[0m16:29:52.048087 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:52.048483 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:52.048728 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__19l2bevu"
[0m16:29:52.048983 [debug] [MainThread]: On MetricFlow_request_mf_rid__19l2bevu: SELECT
  a.average_booking_value / b.max_booking_value AS lux_booking_fraction_of_max_value
  , COALESCE(a.ds, b.ds) AS metric_time__day
FROM (
  SELECT
    CAST(AVG(fct_bookings.booking_value) AS DOUBLE ) AS average_booking_value
    , fct_bookings.ds
  FROM *****.fct_bookings fct_bookings
  LEFT OUTER JOIN *****.dim_listings_latest listings_latest
  ON fct_bookings.listing_id = listings_latest.listing_id
  WHERE listings_latest.is_lux
  GROUP BY fct_bookings.ds
) a
FULL OUTER JOIN (
  SELECT
    CAST(NULLIF(MAX(booking_value), 0) AS DOUBLE ) AS max_booking_value
    , ds
  FROM *****.fct_bookings
  GROUP BY ds
) b
ON a.ds = b.ds
[0m16:29:52.050881 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:52.051858 [debug] [MainThread]: On MetricFlow_request_mf_rid__19l2bevu: ROLLBACK
[0m16:29:52.052183 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__19l2bevu'
[0m16:29:52.052416 [debug] [MainThread]: On MetricFlow_request_mf_rid__19l2bevu: Close
[0m16:29:52.799026 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__19l2bevu, now MetricFlow_request_mf_rid__rhtl1ct0)
[0m16:29:52.799404 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__rhtl1ct0"
[0m16:29:52.799674 [debug] [MainThread]: On MetricFlow_request_mf_rid__rhtl1ct0: BEGIN
[0m16:29:52.799914 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:52.800245 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:52.800480 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__rhtl1ct0"
[0m16:29:52.800780 [debug] [MainThread]: On MetricFlow_request_mf_rid__rhtl1ct0: -- Compute Metrics via Expressions
SELECT
  metric_time__day
  , average_booking_value * bookings / NULLIF(booking_value, 0) AS lux_booking_value_rate_expr
FROM (
  -- Combine Aggregated Outputs
  SELECT
    COALESCE(subq_11.metric_time__day, subq_16.metric_time__day) AS metric_time__day
    , MAX(subq_11.average_booking_value) AS average_booking_value
    , MAX(subq_11.bookings) AS bookings
    , MAX(subq_16.booking_value) AS booking_value
  FROM (
    -- Constrain Output with WHERE
    -- Pass Only Elements: ['average_booking_value', 'bookings', 'metric_time__day']
    -- Aggregate Measures
    -- Compute Metrics via Expressions
    SELECT
      metric_time__day
      , AVG(average_booking_value) AS average_booking_value
      , SUM(bookings) AS bookings
    FROM (
      -- Join Standard Outputs
      -- Pass Only Elements: ['average_booking_value', 'bookings', 'listing__is_lux_latest', 'metric_time__day']
      SELECT
        subq_2.metric_time__day AS metric_time__day
        , listings_latest_src_10000.is_lux AS listing__is_lux_latest
        , subq_2.bookings AS bookings
        , subq_2.average_booking_value AS average_booking_value
      FROM (
        -- Read Elements From Semantic Model 'bookings_source'
        -- Metric Time Dimension 'ds'
        -- Pass Only Elements: ['average_booking_value', 'bookings', 'metric_time__day', 'listing']
        SELECT
          DATE_TRUNC('day', ds) AS metric_time__day
          , listing_id AS listing
          , 1 AS bookings
          , booking_value AS average_booking_value
        FROM *****.fct_bookings bookings_source_src_10000
      ) subq_2
      LEFT OUTER JOIN
        *****.dim_listings_latest listings_latest_src_10000
      ON
        subq_2.listing = listings_latest_src_10000.listing_id
    ) subq_7
    WHERE listing__is_lux_latest
    GROUP BY
      metric_time__day
  ) subq_11
  FULL OUTER JOIN (
    -- Read Elements From Semantic Model 'bookings_source'
    -- Metric Time Dimension 'ds'
    -- Pass Only Elements: ['booking_value', 'metric_time__day']
    -- Aggregate Measures
    -- Compute Metrics via Expressions
    SELECT
      DATE_TRUNC('day', ds) AS metric_time__day
      , SUM(booking_value) AS booking_value
    FROM *****.fct_bookings bookings_source_src_10000
    GROUP BY
      DATE_TRUNC('day', ds)
  ) subq_16
  ON
    subq_11.metric_time__day = subq_16.metric_time__day
  GROUP BY
    COALESCE(subq_11.metric_time__day, subq_16.metric_time__day)
) subq_17
[0m16:29:52.803151 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:52.804558 [debug] [MainThread]: On MetricFlow_request_mf_rid__rhtl1ct0: ROLLBACK
[0m16:29:52.804906 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__rhtl1ct0'
[0m16:29:52.805150 [debug] [MainThread]: On MetricFlow_request_mf_rid__rhtl1ct0: Close
[0m16:29:52.806938 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__rhtl1ct0, now MetricFlow_request_mf_rid__lcxnev30)
[0m16:29:52.807239 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__lcxnev30"
[0m16:29:52.807479 [debug] [MainThread]: On MetricFlow_request_mf_rid__lcxnev30: BEGIN
[0m16:29:52.807713 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:52.808047 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:52.808286 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__lcxnev30"
[0m16:29:52.808544 [debug] [MainThread]: On MetricFlow_request_mf_rid__lcxnev30: SELECT
  a.average_booking_value * a.bookings / b.booking_value AS lux_booking_value_rate_expr
  , COALESCE(a.ds, b.ds) AS metric_time__day
FROM (
  SELECT
    CAST(AVG(fct_bookings.booking_value) AS DOUBLE ) AS average_booking_value
    , SUM(1) AS bookings
    , fct_bookings.ds
  FROM *****.fct_bookings fct_bookings
  LEFT OUTER JOIN *****.dim_listings_latest listings_latest
  ON fct_bookings.listing_id = listings_latest.listing_id
  WHERE listings_latest.is_lux
  GROUP BY fct_bookings.ds
) a
FULL OUTER JOIN (
  SELECT
    CAST(NULLIF(SUM(booking_value), 0) AS DOUBLE ) AS booking_value
    , ds
  FROM *****.fct_bookings
  GROUP BY ds
) b
ON a.ds = b.ds
[0m16:29:52.810329 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:52.811224 [debug] [MainThread]: On MetricFlow_request_mf_rid__lcxnev30: ROLLBACK
[0m16:29:52.811570 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__lcxnev30'
[0m16:29:52.811837 [debug] [MainThread]: On MetricFlow_request_mf_rid__lcxnev30: Close
[0m16:29:53.287630 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__lcxnev30, now MetricFlow_request_mf_rid__efso75rx)
[0m16:29:53.288042 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__efso75rx"
[0m16:29:53.288292 [debug] [MainThread]: On MetricFlow_request_mf_rid__efso75rx: BEGIN
[0m16:29:53.288526 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:53.288890 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:53.289121 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__efso75rx"
[0m16:29:53.289400 [debug] [MainThread]: On MetricFlow_request_mf_rid__efso75rx: -- Compute Metrics via Expressions
SELECT
  metric_time__day
  , CAST(booking_value_with_is_instant_constraint AS DOUBLE) / CAST(NULLIF(booking_value, 0) AS DOUBLE) AS instant_booking_value_ratio
FROM (
  -- Combine Aggregated Outputs
  SELECT
    COALESCE(subq_6.metric_time__day, subq_11.metric_time__day) AS metric_time__day
    , MAX(subq_6.booking_value_with_is_instant_constraint) AS booking_value_with_is_instant_constraint
    , MAX(subq_11.booking_value) AS booking_value
  FROM (
    -- Constrain Output with WHERE
    -- Pass Only Elements: ['booking_value', 'metric_time__day']
    -- Aggregate Measures
    -- Compute Metrics via Expressions
    SELECT
      metric_time__day
      , SUM(booking_value) AS booking_value_with_is_instant_constraint
    FROM (
      -- Read Elements From Semantic Model 'bookings_source'
      -- Metric Time Dimension 'ds'
      -- Pass Only Elements: ['booking_value', 'booking__is_instant', 'metric_time__day']
      SELECT
        DATE_TRUNC('day', ds) AS metric_time__day
        , is_instant AS booking__is_instant
        , booking_value
      FROM *****.fct_bookings bookings_source_src_10000
    ) subq_2
    WHERE booking__is_instant
    GROUP BY
      metric_time__day
  ) subq_6
  FULL OUTER JOIN (
    -- Read Elements From Semantic Model 'bookings_source'
    -- Metric Time Dimension 'ds'
    -- Pass Only Elements: ['booking_value', 'metric_time__day']
    -- Aggregate Measures
    -- Compute Metrics via Expressions
    SELECT
      DATE_TRUNC('day', ds) AS metric_time__day
      , SUM(booking_value) AS booking_value
    FROM *****.fct_bookings bookings_source_src_10000
    GROUP BY
      DATE_TRUNC('day', ds)
  ) subq_11
  ON
    subq_6.metric_time__day = subq_11.metric_time__day
  GROUP BY
    COALESCE(subq_6.metric_time__day, subq_11.metric_time__day)
) subq_12
[0m16:29:53.291444 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:53.292596 [debug] [MainThread]: On MetricFlow_request_mf_rid__efso75rx: ROLLBACK
[0m16:29:53.292959 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__efso75rx'
[0m16:29:53.293234 [debug] [MainThread]: On MetricFlow_request_mf_rid__efso75rx: Close
[0m16:29:53.295102 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__efso75rx, now MetricFlow_request_mf_rid__nbou40r4)
[0m16:29:53.295449 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__nbou40r4"
[0m16:29:53.295701 [debug] [MainThread]: On MetricFlow_request_mf_rid__nbou40r4: BEGIN
[0m16:29:53.295933 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:53.296278 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:53.296517 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__nbou40r4"
[0m16:29:53.296761 [debug] [MainThread]: On MetricFlow_request_mf_rid__nbou40r4: SELECT
  a.booking_value / b.booking_value AS instant_booking_value_ratio
  , COALESCE(a.ds, b.ds) AS metric_time__day
FROM (
  SELECT
    CAST(SUM(booking_value) AS DOUBLE ) AS booking_value
    , ds
  FROM *****.fct_bookings
  WHERE is_instant
  GROUP BY ds
) a
FULL OUTER JOIN (
  SELECT
    CAST(NULLIF(SUM(booking_value), 0) AS DOUBLE ) AS booking_value
    , ds
  FROM *****.fct_bookings
  GROUP BY ds
) b
ON a.ds = b.ds
[0m16:29:53.299055 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:53.303789 [debug] [MainThread]: On MetricFlow_request_mf_rid__nbou40r4: ROLLBACK
[0m16:29:53.304881 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__nbou40r4'
[0m16:29:53.305212 [debug] [MainThread]: On MetricFlow_request_mf_rid__nbou40r4: Close
[0m16:29:53.966839 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__nbou40r4, now MetricFlow_request_mf_rid__8hcmh6ks)
[0m16:29:53.967255 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__8hcmh6ks"
[0m16:29:53.967511 [debug] [MainThread]: On MetricFlow_request_mf_rid__8hcmh6ks: BEGIN
[0m16:29:53.967749 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:53.968121 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:53.968353 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__8hcmh6ks"
[0m16:29:53.968748 [debug] [MainThread]: On MetricFlow_request_mf_rid__8hcmh6ks: -- Compute Metrics via Expressions
SELECT
  metric_time__day
  , CAST(west_coast_balance_first_day AS DOUBLE) / CAST(NULLIF(east_coast_balance_first_dat, 0) AS DOUBLE) AS regional_starting_balance_ratios
FROM (
  -- Combine Aggregated Outputs
  SELECT
    COALESCE(subq_13.metric_time__day, subq_27.metric_time__day) AS metric_time__day
    , MAX(subq_13.west_coast_balance_first_day) AS west_coast_balance_first_day
    , MAX(subq_27.east_coast_balance_first_dat) AS east_coast_balance_first_dat
  FROM (
    -- Join on MIN(ds) and [] grouping by metric_time
    -- Pass Only Elements: ['total_account_balance_first_day', 'metric_time__day']
    -- Aggregate Measures
    -- Compute Metrics via Expressions
    SELECT
      subq_7.metric_time__day AS metric_time__day
      , SUM(subq_7.total_account_balance_first_day) AS west_coast_balance_first_day
    FROM (
      -- Constrain Output with WHERE
      SELECT
        ds__day
        , metric_time__day
        , total_account_balance_first_day
      FROM (
        -- Join Standard Outputs
        -- Pass Only Elements: ['total_account_balance_first_day', 'user__home_state_latest', 'metric_time__day', 'ds__day']
        SELECT
          DATE_TRUNC('day', accounts_source_src_10000.ds) AS ds__day
          , DATE_TRUNC('day', accounts_source_src_10000.ds) AS metric_time__day
          , users_latest_src_10000.home_state_latest AS user__home_state_latest
          , accounts_source_src_10000.account_balance AS total_account_balance_first_day
        FROM *****.fct_accounts accounts_source_src_10000
        LEFT OUTER JOIN
          *****.dim_users_latest users_latest_src_10000
        ON
          accounts_source_src_10000.user_id = users_latest_src_10000.user_id
      ) subq_6
      WHERE user__home_state_latest IN ('CA', 'HI', 'WA')
    ) subq_7
    INNER JOIN (
      -- Constrain Output with WHERE
      -- Filter row on MIN(ds__day)
      SELECT
        metric_time__day
        , MIN(ds__day) AS ds__day__complete
      FROM (
        -- Join Standard Outputs
        -- Pass Only Elements: ['total_account_balance_first_day', 'user__home_state_latest', 'metric_time__day', 'ds__day']
        SELECT
          DATE_TRUNC('day', accounts_source_src_10000.ds) AS ds__day
          , DATE_TRUNC('day', accounts_source_src_10000.ds) AS metric_time__day
          , users_latest_src_10000.home_state_latest AS user__home_state_latest
        FROM *****.fct_accounts accounts_source_src_10000
        LEFT OUTER JOIN
          *****.dim_users_latest users_latest_src_10000
        ON
          accounts_source_src_10000.user_id = users_latest_src_10000.user_id
      ) subq_6
      WHERE user__home_state_latest IN ('CA', 'HI', 'WA')
      GROUP BY
        metric_time__day
    ) subq_9
    ON
      subq_7.ds__day = subq_9.ds__day__complete
    GROUP BY
      subq_7.metric_time__day
  ) subq_13
  FULL OUTER JOIN (
    -- Join on MIN(ds) and [] grouping by metric_time
    -- Pass Only Elements: ['total_account_balance_first_day', 'metric_time__day']
    -- Aggregate Measures
    -- Compute Metrics via Expressions
    SELECT
      subq_21.metric_time__day AS metric_time__day
      , SUM(subq_21.total_account_balance_first_day) AS east_coast_balance_first_dat
    FROM (
      -- Constrain Output with WHERE
      SELECT
        ds__day
        , metric_time__day
        , total_account_balance_first_day
      FROM (
        -- Join Standard Outputs
        -- Pass Only Elements: ['total_account_balance_first_day', 'user__home_state_latest', 'metric_time__day', 'ds__day']
        SELECT
          DATE_TRUNC('day', accounts_source_src_10000.ds) AS ds__day
          , DATE_TRUNC('day', accounts_source_src_10000.ds) AS metric_time__day
          , users_latest_src_10000.home_state_latest AS user__home_state_latest
          , accounts_source_src_10000.account_balance AS total_account_balance_first_day
        FROM *****.fct_accounts accounts_source_src_10000
        LEFT OUTER JOIN
          *****.dim_users_latest users_latest_src_10000
        ON
          accounts_source_src_10000.user_id = users_latest_src_10000.user_id
      ) subq_20
      WHERE user__home_state_latest IN ('MD', 'NY', 'TX')
    ) subq_21
    INNER JOIN (
      -- Constrain Output with WHERE
      -- Filter row on MIN(ds__day)
      SELECT
        metric_time__day
        , MIN(ds__day) AS ds__day__complete
      FROM (
        -- Join Standard Outputs
        -- Pass Only Elements: ['total_account_balance_first_day', 'user__home_state_latest', 'metric_time__day', 'ds__day']
        SELECT
          DATE_TRUNC('day', accounts_source_src_10000.ds) AS ds__day
          , DATE_TRUNC('day', accounts_source_src_10000.ds) AS metric_time__day
          , users_latest_src_10000.home_state_latest AS user__home_state_latest
        FROM *****.fct_accounts accounts_source_src_10000
        LEFT OUTER JOIN
          *****.dim_users_latest users_latest_src_10000
        ON
          accounts_source_src_10000.user_id = users_latest_src_10000.user_id
      ) subq_20
      WHERE user__home_state_latest IN ('MD', 'NY', 'TX')
      GROUP BY
        metric_time__day
    ) subq_23
    ON
      subq_21.ds__day = subq_23.ds__day__complete
    GROUP BY
      subq_21.metric_time__day
  ) subq_27
  ON
    subq_13.metric_time__day = subq_27.metric_time__day
  GROUP BY
    COALESCE(subq_13.metric_time__day, subq_27.metric_time__day)
) subq_28
[0m16:29:53.972425 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:53.973466 [debug] [MainThread]: On MetricFlow_request_mf_rid__8hcmh6ks: ROLLBACK
[0m16:29:53.973794 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__8hcmh6ks'
[0m16:29:53.974036 [debug] [MainThread]: On MetricFlow_request_mf_rid__8hcmh6ks: Close
[0m16:29:53.976037 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__8hcmh6ks, now MetricFlow_request_mf_rid__o666d7ee)
[0m16:29:53.976330 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__o666d7ee"
[0m16:29:53.976570 [debug] [MainThread]: On MetricFlow_request_mf_rid__o666d7ee: BEGIN
[0m16:29:53.976798 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:53.977109 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:53.977337 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__o666d7ee"
[0m16:29:53.977607 [debug] [MainThread]: On MetricFlow_request_mf_rid__o666d7ee: SELECT
  a.total_account_balance_first_day / b.total_account_balance_first_day AS regional_starting_balance_ratios
  , COALESCE(a.ds, b.ds) AS metric_time__day
FROM (
  SELECT
    CAST(SUM(account_balance) AS DOUBLE) AS total_account_balance_first_day
    , fa_west_filtered.ds
  FROM (
    SELECT
      fa_west.ds
      , fa_west.ds AS metric_time__day
      , user_id AS user
      , account_balance
    FROM *****.fct_accounts fa_west
    INNER JOIN (
      SELECT
        MIN(ds) AS ds__min
      FROM *****.fct_accounts
      GROUP BY
        ds
    ) c
    ON
      fa_west.ds = c.ds__min
  ) fa_west_filtered
  LEFT OUTER JOIN *****.dim_users_latest dul_west
  ON fa_west_filtered.user = dul_west.user_id
  WHERE dul_west.home_state_latest IN ('CA', 'HI', 'WA')
  GROUP BY fa_west_filtered.ds
) a
FULL OUTER JOIN (
  SELECT
    CAST(SUM(account_balance) AS DOUBLE) AS total_account_balance_first_day
    , fa_east_filtered.ds
  FROM (
    SELECT
      fa_east.ds
      , fa_east.ds AS metric_time__day
      , user_id AS user
      , account_balance
    FROM *****.fct_accounts fa_east
    INNER JOIN (
      SELECT
        MIN(ds) AS ds__min
      FROM *****.fct_accounts
      GROUP BY
        ds
    ) d
    ON
      fa_east.ds = d.ds__min
  ) fa_east_filtered
  LEFT OUTER JOIN *****.dim_users_latest dul_east
  ON fa_east_filtered.user = dul_east.user_id
  WHERE dul_east.home_state_latest IN ('MD', 'NY', 'TX')
  GROUP BY fa_east_filtered.ds
) b
ON a.ds = b.ds
[0m16:29:53.981632 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:53.985024 [debug] [MainThread]: On MetricFlow_request_mf_rid__o666d7ee: ROLLBACK
[0m16:29:53.986663 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__o666d7ee'
[0m16:29:53.987502 [debug] [MainThread]: On MetricFlow_request_mf_rid__o666d7ee: Close
[0m16:29:54.273503 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__o666d7ee, now MetricFlow_request_mf_rid__w8iu5tf7)
[0m16:29:54.273923 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__w8iu5tf7"
[0m16:29:54.274171 [debug] [MainThread]: On MetricFlow_request_mf_rid__w8iu5tf7: BEGIN
[0m16:29:54.274400 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:54.274766 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:54.274995 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__w8iu5tf7"
[0m16:29:54.275242 [debug] [MainThread]: On MetricFlow_request_mf_rid__w8iu5tf7: -- Compute Metrics via Expressions
SELECT
  metric_time__day
  , delayed_bookings * 2 AS double_counted_delayed_bookings
FROM (
  -- Constrain Output with WHERE
  -- Pass Only Elements: ['bookings', 'metric_time__day']
  -- Aggregate Measures
  -- Compute Metrics via Expressions
  SELECT
    metric_time__day
    , SUM(bookings) AS delayed_bookings
  FROM (
    -- Read Elements From Semantic Model 'bookings_source'
    -- Metric Time Dimension 'ds'
    -- Pass Only Elements: ['bookings', 'booking__is_instant', 'metric_time__day']
    SELECT
      DATE_TRUNC('day', ds) AS metric_time__day
      , is_instant AS booking__is_instant
      , 1 AS bookings
    FROM *****.fct_bookings bookings_source_src_10000
  ) subq_2
  WHERE NOT booking__is_instant
  GROUP BY
    metric_time__day
) subq_6
[0m16:29:54.276301 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:54.277315 [debug] [MainThread]: On MetricFlow_request_mf_rid__w8iu5tf7: ROLLBACK
[0m16:29:54.277674 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__w8iu5tf7'
[0m16:29:54.277922 [debug] [MainThread]: On MetricFlow_request_mf_rid__w8iu5tf7: Close
[0m16:29:54.280263 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__w8iu5tf7, now MetricFlow_request_mf_rid__ru4d3oda)
[0m16:29:54.280624 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__ru4d3oda"
[0m16:29:54.282398 [debug] [MainThread]: On MetricFlow_request_mf_rid__ru4d3oda: BEGIN
[0m16:29:54.283119 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:54.284078 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:54.284393 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__ru4d3oda"
[0m16:29:54.284668 [debug] [MainThread]: On MetricFlow_request_mf_rid__ru4d3oda: SELECT
  SUM(1) * 2 AS double_counted_delayed_bookings
  , ds AS metric_time__day
FROM *****.fct_bookings
WHERE NOT is_instant
GROUP BY ds
[0m16:29:54.285462 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:54.286347 [debug] [MainThread]: On MetricFlow_request_mf_rid__ru4d3oda: ROLLBACK
[0m16:29:54.286661 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__ru4d3oda'
[0m16:29:54.286906 [debug] [MainThread]: On MetricFlow_request_mf_rid__ru4d3oda: Close
[0m16:29:54.488526 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__ru4d3oda, now MetricFlow_request_mf_rid__kie0r3mi)
[0m16:29:54.488974 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__kie0r3mi"
[0m16:29:54.489227 [debug] [MainThread]: On MetricFlow_request_mf_rid__kie0r3mi: BEGIN
[0m16:29:54.489463 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:54.489845 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:54.490108 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__kie0r3mi"
[0m16:29:54.490354 [debug] [MainThread]: On MetricFlow_request_mf_rid__kie0r3mi: -- Read Elements From Semantic Model 'bookings_source'
-- Metric Time Dimension 'ds'
-- Pass Only Elements: ['booking_value',]
-- Aggregate Measures
-- Compute Metrics via Expressions
SELECT
  SUM(booking_value) AS booking_value
FROM *****.fct_bookings bookings_source_src_10000
[0m16:29:54.496158 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:54.498991 [debug] [MainThread]: On MetricFlow_request_mf_rid__kie0r3mi: ROLLBACK
[0m16:29:54.500085 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__kie0r3mi'
[0m16:29:54.500910 [debug] [MainThread]: On MetricFlow_request_mf_rid__kie0r3mi: Close
[0m16:29:54.504469 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__kie0r3mi, now MetricFlow_request_mf_rid__iim00k9f)
[0m16:29:54.504893 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__iim00k9f"
[0m16:29:54.505166 [debug] [MainThread]: On MetricFlow_request_mf_rid__iim00k9f: BEGIN
[0m16:29:54.505425 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:54.505806 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:54.506053 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__iim00k9f"
[0m16:29:54.506288 [debug] [MainThread]: On MetricFlow_request_mf_rid__iim00k9f: SELECT
  SUM(booking_value) AS booking_value
FROM *****.fct_bookings
[0m16:29:54.506739 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:54.509513 [debug] [MainThread]: On MetricFlow_request_mf_rid__iim00k9f: ROLLBACK
[0m16:29:54.509950 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__iim00k9f'
[0m16:29:54.510200 [debug] [MainThread]: On MetricFlow_request_mf_rid__iim00k9f: Close
[0m16:29:54.723764 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__iim00k9f, now MetricFlow_request_mf_rid__xhbvfdin)
[0m16:29:54.724253 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__xhbvfdin"
[0m16:29:54.724534 [debug] [MainThread]: On MetricFlow_request_mf_rid__xhbvfdin: BEGIN
[0m16:29:54.724792 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:54.725230 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:54.725542 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__xhbvfdin"
[0m16:29:54.725805 [debug] [MainThread]: On MetricFlow_request_mf_rid__xhbvfdin: -- Read Elements From Semantic Model 'bookings_source'
-- Metric Time Dimension 'ds'
-- Constrain Time Range to [2020-01-01T00:00:00, 2020-01-01T00:00:00]
-- Pass Only Elements: ['booking_value',]
-- Aggregate Measures
-- Compute Metrics via Expressions
SELECT
  SUM(booking_value) AS booking_value
FROM *****.fct_bookings bookings_source_src_10000
WHERE DATE_TRUNC('day', ds) BETWEEN '2020-01-01' AND '2020-01-01'
[0m16:29:54.726413 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:54.727265 [debug] [MainThread]: On MetricFlow_request_mf_rid__xhbvfdin: ROLLBACK
[0m16:29:54.727581 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__xhbvfdin'
[0m16:29:54.727815 [debug] [MainThread]: On MetricFlow_request_mf_rid__xhbvfdin: Close
[0m16:29:54.730679 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__xhbvfdin, now MetricFlow_request_mf_rid__3ifsfko7)
[0m16:29:54.731048 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__3ifsfko7"
[0m16:29:54.731295 [debug] [MainThread]: On MetricFlow_request_mf_rid__3ifsfko7: BEGIN
[0m16:29:54.731594 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:54.732011 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:54.732256 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__3ifsfko7"
[0m16:29:54.732488 [debug] [MainThread]: On MetricFlow_request_mf_rid__3ifsfko7: SELECT
  SUM(booking_value) AS booking_value
FROM *****.fct_bookings
WHERE CAST(ds AS TIMESTAMP) >= CAST('2020-01-01' AS TIMESTAMP) AND CAST(ds AS TIMESTAMP) < CAST('2020-01-02' AS TIMESTAMP)
[0m16:29:54.733037 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:54.733808 [debug] [MainThread]: On MetricFlow_request_mf_rid__3ifsfko7: ROLLBACK
[0m16:29:54.734115 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__3ifsfko7'
[0m16:29:54.734343 [debug] [MainThread]: On MetricFlow_request_mf_rid__3ifsfko7: Close
[0m16:29:54.953935 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__3ifsfko7, now MetricFlow_request_mf_rid__ze9vohw7)
[0m16:29:54.954371 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__ze9vohw7"
[0m16:29:54.954627 [debug] [MainThread]: On MetricFlow_request_mf_rid__ze9vohw7: BEGIN
[0m16:29:54.954864 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:54.955237 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:54.955469 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__ze9vohw7"
[0m16:29:54.955707 [debug] [MainThread]: On MetricFlow_request_mf_rid__ze9vohw7: -- Constrain Output with WHERE
-- Pass Only Elements: ['booking_value',]
-- Aggregate Measures
-- Compute Metrics via Expressions
SELECT
  SUM(booking_value) AS booking_value
FROM (
  -- Read Elements From Semantic Model 'bookings_source'
  -- Metric Time Dimension 'ds'
  -- Pass Only Elements: ['booking_value', 'booking__is_instant']
  SELECT
    is_instant AS booking__is_instant
    , booking_value
  FROM *****.fct_bookings bookings_source_src_10000
) subq_2
WHERE booking__is_instant
[0m16:29:54.956212 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:54.957951 [debug] [MainThread]: On MetricFlow_request_mf_rid__ze9vohw7: ROLLBACK
[0m16:29:54.958968 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__ze9vohw7'
[0m16:29:54.959683 [debug] [MainThread]: On MetricFlow_request_mf_rid__ze9vohw7: Close
[0m16:29:54.964585 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__ze9vohw7, now MetricFlow_request_mf_rid__700il70v)
[0m16:29:54.965620 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__700il70v"
[0m16:29:54.966357 [debug] [MainThread]: On MetricFlow_request_mf_rid__700il70v: BEGIN
[0m16:29:54.967003 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:54.968344 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:54.968722 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__700il70v"
[0m16:29:54.968984 [debug] [MainThread]: On MetricFlow_request_mf_rid__700il70v: SELECT
  SUM(booking_value) AS booking_value
FROM *****.fct_bookings
WHERE is_instant
[0m16:29:54.969500 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:54.970284 [debug] [MainThread]: On MetricFlow_request_mf_rid__700il70v: ROLLBACK
[0m16:29:54.972339 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__700il70v'
[0m16:29:54.973150 [debug] [MainThread]: On MetricFlow_request_mf_rid__700il70v: Close
[0m16:29:55.328505 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__700il70v, now MetricFlow_request_mf_rid__27wva029)
[0m16:29:55.328957 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__27wva029"
[0m16:29:55.329210 [debug] [MainThread]: On MetricFlow_request_mf_rid__27wva029: BEGIN
[0m16:29:55.329441 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:55.329819 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:55.330052 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__27wva029"
[0m16:29:55.330303 [debug] [MainThread]: On MetricFlow_request_mf_rid__27wva029: -- Combine Aggregated Outputs
SELECT
  MAX(subq_4.bookings) AS bookings
  , MAX(subq_9.listings) AS listings
FROM (
  -- Read Elements From Semantic Model 'bookings_source'
  -- Metric Time Dimension 'ds'
  -- Pass Only Elements: ['bookings',]
  -- Aggregate Measures
  -- Compute Metrics via Expressions
  SELECT
    SUM(1) AS bookings
  FROM *****.fct_bookings bookings_source_src_10000
) subq_4
CROSS JOIN (
  -- Read Elements From Semantic Model 'listings_latest'
  -- Metric Time Dimension 'ds'
  -- Pass Only Elements: ['listings',]
  -- Aggregate Measures
  -- Compute Metrics via Expressions
  SELECT
    SUM(1) AS listings
  FROM *****.dim_listings_latest listings_latest_src_10000
) subq_9
[0m16:29:55.331665 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:55.334158 [debug] [MainThread]: On MetricFlow_request_mf_rid__27wva029: ROLLBACK
[0m16:29:55.334991 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__27wva029'
[0m16:29:55.335279 [debug] [MainThread]: On MetricFlow_request_mf_rid__27wva029: Close
[0m16:29:55.336947 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__27wva029, now MetricFlow_request_mf_rid__m5ww7lza)
[0m16:29:55.337278 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__m5ww7lza"
[0m16:29:55.337518 [debug] [MainThread]: On MetricFlow_request_mf_rid__m5ww7lza: BEGIN
[0m16:29:55.337744 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:55.338098 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:55.338327 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__m5ww7lza"
[0m16:29:55.338555 [debug] [MainThread]: On MetricFlow_request_mf_rid__m5ww7lza: SELECT
  a.bookings
  , b.listings
FROM (
  SELECT
    SUM(1) AS bookings
  FROM *****.fct_bookings
) a CROSS JOIN (
  SELECT
    SUM(1) AS listings
  FROM *****.dim_listings_latest
) b
[0m16:29:55.339465 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:55.341345 [debug] [MainThread]: On MetricFlow_request_mf_rid__m5ww7lza: ROLLBACK
[0m16:29:55.341783 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__m5ww7lza'
[0m16:29:55.342038 [debug] [MainThread]: On MetricFlow_request_mf_rid__m5ww7lza: Close
[0m16:29:55.693130 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__m5ww7lza, now MetricFlow_request_mf_rid__xb9182wo)
[0m16:29:55.693582 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__xb9182wo"
[0m16:29:55.693839 [debug] [MainThread]: On MetricFlow_request_mf_rid__xb9182wo: BEGIN
[0m16:29:55.694142 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:55.694610 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:55.694892 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__xb9182wo"
[0m16:29:55.695582 [debug] [MainThread]: On MetricFlow_request_mf_rid__xb9182wo: -- Combine Aggregated Outputs
-- Compute Metrics via Expressions
SELECT
  CAST(MAX(subq_4.bookings) AS DOUBLE) / CAST(NULLIF(MAX(subq_9.listings), 0) AS DOUBLE) AS bookings_per_listing
FROM (
  -- Read Elements From Semantic Model 'bookings_source'
  -- Metric Time Dimension 'ds'
  -- Pass Only Elements: ['bookings',]
  -- Aggregate Measures
  -- Compute Metrics via Expressions
  SELECT
    SUM(1) AS bookings
  FROM *****.fct_bookings bookings_source_src_10000
) subq_4
CROSS JOIN (
  -- Read Elements From Semantic Model 'listings_latest'
  -- Metric Time Dimension 'ds'
  -- Pass Only Elements: ['listings',]
  -- Aggregate Measures
  -- Compute Metrics via Expressions
  SELECT
    SUM(1) AS listings
  FROM *****.dim_listings_latest listings_latest_src_10000
) subq_9
[0m16:29:55.696446 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:55.697257 [debug] [MainThread]: On MetricFlow_request_mf_rid__xb9182wo: ROLLBACK
[0m16:29:55.697562 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__xb9182wo'
[0m16:29:55.697794 [debug] [MainThread]: On MetricFlow_request_mf_rid__xb9182wo: Close
[0m16:29:55.699486 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__xb9182wo, now MetricFlow_request_mf_rid__vl3zo1b2)
[0m16:29:55.699807 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__vl3zo1b2"
[0m16:29:55.700054 [debug] [MainThread]: On MetricFlow_request_mf_rid__vl3zo1b2: BEGIN
[0m16:29:55.700682 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:55.701024 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:55.701263 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__vl3zo1b2"
[0m16:29:55.701499 [debug] [MainThread]: On MetricFlow_request_mf_rid__vl3zo1b2: SELECT
  (CAST(a.bookings AS DOUBLE) / CAST(b.listings AS DOUBLE)) AS bookings_per_listing
FROM (
  SELECT
    SUM(1) AS bookings
  FROM *****.fct_bookings
) a CROSS JOIN (
  SELECT
    SUM(1) AS listings
  FROM *****.dim_listings_latest
) b
[0m16:29:55.701964 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:55.702680 [debug] [MainThread]: On MetricFlow_request_mf_rid__vl3zo1b2: ROLLBACK
[0m16:29:55.702968 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__vl3zo1b2'
[0m16:29:55.703190 [debug] [MainThread]: On MetricFlow_request_mf_rid__vl3zo1b2: Close
[0m16:29:56.089402 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__vl3zo1b2, now MetricFlow_request_mf_rid__lkvvu97o)
[0m16:29:56.089902 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__lkvvu97o"
[0m16:29:56.090157 [debug] [MainThread]: On MetricFlow_request_mf_rid__lkvvu97o: BEGIN
[0m16:29:56.090390 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:56.090777 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:56.091035 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__lkvvu97o"
[0m16:29:56.091360 [debug] [MainThread]: On MetricFlow_request_mf_rid__lkvvu97o: -- Compute Metrics via Expressions
SELECT
  metric_time__day
  , booking_value * 0.05 AS booking_fees
FROM (
  -- Read Elements From Semantic Model 'bookings_source'
  -- Metric Time Dimension 'ds'
  -- Pass Only Elements: ['booking_value', 'metric_time__day']
  -- Aggregate Measures
  -- Compute Metrics via Expressions
  SELECT
    DATE_TRUNC('day', ds) AS metric_time__day
    , SUM(booking_value) AS booking_value
  FROM *****.fct_bookings bookings_source_src_10000
  GROUP BY
    DATE_TRUNC('day', ds)
) subq_4
[0m16:29:56.092336 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:56.094319 [debug] [MainThread]: On MetricFlow_request_mf_rid__lkvvu97o: ROLLBACK
[0m16:29:56.094780 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__lkvvu97o'
[0m16:29:56.095054 [debug] [MainThread]: On MetricFlow_request_mf_rid__lkvvu97o: Close
[0m16:29:56.096809 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__lkvvu97o, now MetricFlow_request_mf_rid__wr3c0k40)
[0m16:29:56.097177 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__wr3c0k40"
[0m16:29:56.097429 [debug] [MainThread]: On MetricFlow_request_mf_rid__wr3c0k40: BEGIN
[0m16:29:56.097672 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:56.098071 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:56.098327 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__wr3c0k40"
[0m16:29:56.098585 [debug] [MainThread]: On MetricFlow_request_mf_rid__wr3c0k40: SELECT
  SUM(booking_value) * 0.05 AS booking_fees
  , ds AS metric_time__day
FROM *****.fct_bookings
GROUP BY ds;
[0m16:29:56.099490 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:56.101004 [debug] [MainThread]: On MetricFlow_request_mf_rid__wr3c0k40: ROLLBACK
[0m16:29:56.102942 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__wr3c0k40'
[0m16:29:56.103716 [debug] [MainThread]: On MetricFlow_request_mf_rid__wr3c0k40: Close
[0m16:29:57.973419 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__wr3c0k40, now MetricFlow_request_mf_rid__amzii83o)
[0m16:29:57.973819 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__amzii83o"
[0m16:29:57.974073 [debug] [MainThread]: On MetricFlow_request_mf_rid__amzii83o: BEGIN
[0m16:29:57.974307 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:57.974689 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:57.974923 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__amzii83o"
[0m16:29:57.975148 [debug] [MainThread]: On MetricFlow_request_mf_rid__amzii83o: SELECT DATE_TRUNC('year', CAST('2015-06-15' AS TIMESTAMP))
[0m16:29:57.975533 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:57.976307 [debug] [MainThread]: On MetricFlow_request_mf_rid__amzii83o: ROLLBACK
[0m16:29:57.976634 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__amzii83o'
[0m16:29:57.976864 [debug] [MainThread]: On MetricFlow_request_mf_rid__amzii83o: Close
[0m16:29:57.979058 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__amzii83o, now MetricFlow_request_mf_rid__31wfihd5)
[0m16:29:57.980799 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__31wfihd5"
[0m16:29:57.981059 [debug] [MainThread]: On MetricFlow_request_mf_rid__31wfihd5: BEGIN
[0m16:29:57.981293 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:57.981604 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:57.981837 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__31wfihd5"
[0m16:29:57.982062 [debug] [MainThread]: On MetricFlow_request_mf_rid__31wfihd5: SELECT DATE_TRUNC('quarter', CAST('2015-07-01' AS TIMESTAMP))
[0m16:29:57.982435 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:57.983543 [debug] [MainThread]: On MetricFlow_request_mf_rid__31wfihd5: ROLLBACK
[0m16:29:57.986778 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__31wfihd5'
[0m16:29:57.988150 [debug] [MainThread]: On MetricFlow_request_mf_rid__31wfihd5: Close
[0m16:29:57.996962 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__31wfihd5, now MetricFlow_request_mf_rid__v2r99m53)
[0m16:29:57.998034 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__v2r99m53"
[0m16:29:57.998316 [debug] [MainThread]: On MetricFlow_request_mf_rid__v2r99m53: BEGIN
[0m16:29:57.998553 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:57.998892 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:57.999120 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__v2r99m53"
[0m16:29:57.999343 [debug] [MainThread]: On MetricFlow_request_mf_rid__v2r99m53: SELECT DATE_TRUNC('quarter', CAST('2015-11-17' AS TIMESTAMP))
[0m16:29:57.999703 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:58.000721 [debug] [MainThread]: On MetricFlow_request_mf_rid__v2r99m53: ROLLBACK
[0m16:29:58.001410 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__v2r99m53'
[0m16:29:58.001664 [debug] [MainThread]: On MetricFlow_request_mf_rid__v2r99m53: Close
[0m16:29:58.005544 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__v2r99m53, now MetricFlow_request_mf_rid__5172ax7c)
[0m16:29:58.005880 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__5172ax7c"
[0m16:29:58.006129 [debug] [MainThread]: On MetricFlow_request_mf_rid__5172ax7c: BEGIN
[0m16:29:58.006361 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:58.006687 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:58.006941 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__5172ax7c"
[0m16:29:58.008294 [debug] [MainThread]: On MetricFlow_request_mf_rid__5172ax7c: SELECT EXTRACT(quarter FROM CAST('2015-11-17' AS TIMESTAMP))
[0m16:29:58.008734 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:58.009535 [debug] [MainThread]: On MetricFlow_request_mf_rid__5172ax7c: ROLLBACK
[0m16:29:58.009846 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__5172ax7c'
[0m16:29:58.010078 [debug] [MainThread]: On MetricFlow_request_mf_rid__5172ax7c: Close
[0m16:29:58.012644 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__5172ax7c, now MetricFlow_request_mf_rid__lcczxc66)
[0m16:29:58.012966 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__lcczxc66"
[0m16:29:58.013209 [debug] [MainThread]: On MetricFlow_request_mf_rid__lcczxc66: BEGIN
[0m16:29:58.013434 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:58.013760 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:58.013988 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__lcczxc66"
[0m16:29:58.014213 [debug] [MainThread]: On MetricFlow_request_mf_rid__lcczxc66: SELECT EXTRACT(isodow FROM CAST('2023-08-29' AS TIMESTAMP))
[0m16:29:58.014565 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:58.015299 [debug] [MainThread]: On MetricFlow_request_mf_rid__lcczxc66: ROLLBACK
[0m16:29:58.015588 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__lcczxc66'
[0m16:29:58.015809 [debug] [MainThread]: On MetricFlow_request_mf_rid__lcczxc66: Close
[0m16:29:58.018676 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__lcczxc66, now MetricFlow_request_mf_rid__kmu4s7te)
[0m16:29:58.018986 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__kmu4s7te"
[0m16:29:58.019224 [debug] [MainThread]: On MetricFlow_request_mf_rid__kmu4s7te: BEGIN
[0m16:29:58.019450 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:58.019740 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:58.019964 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__kmu4s7te"
[0m16:29:58.020193 [debug] [MainThread]: On MetricFlow_request_mf_rid__kmu4s7te: SELECT EXTRACT(isodow FROM CAST('2023-09-01' AS TIMESTAMP))
[0m16:29:58.020509 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:58.021256 [debug] [MainThread]: On MetricFlow_request_mf_rid__kmu4s7te: ROLLBACK
[0m16:29:58.021556 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__kmu4s7te'
[0m16:29:58.021780 [debug] [MainThread]: On MetricFlow_request_mf_rid__kmu4s7te: Close
[0m16:29:58.026208 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__kmu4s7te, now MetricFlow_request_mf_rid__hscx4w1t)
[0m16:29:58.026533 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__hscx4w1t"
[0m16:29:58.026776 [debug] [MainThread]: On MetricFlow_request_mf_rid__hscx4w1t: BEGIN
[0m16:29:58.027006 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:58.027332 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:58.027560 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__hscx4w1t"
[0m16:29:58.027782 [debug] [MainThread]: On MetricFlow_request_mf_rid__hscx4w1t: SELECT 1 AS y
[0m16:29:58.028174 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:58.028925 [debug] [MainThread]: On MetricFlow_request_mf_rid__hscx4w1t: ROLLBACK
[0m16:29:58.029227 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__hscx4w1t'
[0m16:29:58.029455 [debug] [MainThread]: On MetricFlow_request_mf_rid__hscx4w1t: Close
[0m16:29:58.033660 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__hscx4w1t, now MetricFlow_request_mf_rid__tkkc1l9o)
[0m16:29:58.033971 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__tkkc1l9o"
[0m16:29:58.034210 [debug] [MainThread]: On MetricFlow_request_mf_rid__tkkc1l9o: BEGIN
[0m16:29:58.034435 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:58.034732 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:58.034960 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__tkkc1l9o"
[0m16:29:58.035185 [debug] [MainThread]: On MetricFlow_request_mf_rid__tkkc1l9o: SELECT foo FROM ( SELECT 'abba' AS foo ) source0 WHERE foo LIKE '%a'
[0m16:29:58.035821 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:58.036583 [debug] [MainThread]: On MetricFlow_request_mf_rid__tkkc1l9o: ROLLBACK
[0m16:29:58.036890 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__tkkc1l9o'
[0m16:29:58.037121 [debug] [MainThread]: On MetricFlow_request_mf_rid__tkkc1l9o: Close
[0m16:29:58.037590 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__tkkc1l9o, now MetricFlow_request_mf_rid__5f99x2s4)
[0m16:29:58.037848 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__5f99x2s4"
[0m16:29:58.038075 [debug] [MainThread]: On MetricFlow_request_mf_rid__5f99x2s4: BEGIN
[0m16:29:58.038295 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:58.038573 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:58.038801 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__5f99x2s4"
[0m16:29:58.039030 [debug] [MainThread]: On MetricFlow_request_mf_rid__5f99x2s4: SELECT foo FROM ( SELECT 'abba' AS foo ) source0 WHERE foo LIKE '%a'
[0m16:29:58.039376 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:58.040050 [debug] [MainThread]: On MetricFlow_request_mf_rid__5f99x2s4: ROLLBACK
[0m16:29:58.040332 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__5f99x2s4'
[0m16:29:58.040555 [debug] [MainThread]: On MetricFlow_request_mf_rid__5f99x2s4: Close
[0m16:29:58.087406 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__5f99x2s4, now MetricFlow_request_mf_rid__b1z7rbrk)
[0m16:29:58.087982 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__b1z7rbrk"
[0m16:29:58.088239 [debug] [MainThread]: On MetricFlow_request_mf_rid__b1z7rbrk: BEGIN
[0m16:29:58.088473 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:58.088851 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:58.089089 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__b1z7rbrk"
[0m16:29:58.089319 [debug] [MainThread]: On MetricFlow_request_mf_rid__b1z7rbrk: CREATE SCHEMA IF NOT EXISTS mf_test_snapshot_schema_rawaiued
[0m16:29:58.089626 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:58.090239 [debug] [MainThread]: On MetricFlow_request_mf_rid__b1z7rbrk: COMMIT
[0m16:29:58.090497 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__b1z7rbrk"
[0m16:29:58.090735 [debug] [MainThread]: On MetricFlow_request_mf_rid__b1z7rbrk: COMMIT
[0m16:29:58.091037 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:58.091287 [debug] [MainThread]: On MetricFlow_request_mf_rid__b1z7rbrk: Close
[0m16:29:58.092146 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__b1z7rbrk, now MetricFlow_create_from_dataframe)
[0m16:29:58.093508 [debug] [MainThread]: Using duckdb connection "MetricFlow_create_from_dataframe"
[0m16:29:58.093806 [debug] [MainThread]: On MetricFlow_create_from_dataframe: BEGIN
[0m16:29:58.094061 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:58.094399 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:58.094633 [debug] [MainThread]: Using duckdb connection "MetricFlow_create_from_dataframe"
[0m16:29:58.094864 [debug] [MainThread]: On MetricFlow_create_from_dataframe: CREATE TABLE IF NOT EXISTS mf_test_snapshot_schema_rawaiued.example_snapshot (col0 boolean, col1 bigint, col2 bigint, col3 TIMESTAMP, col4 text)
[0m16:29:58.095220 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:58.095862 [debug] [MainThread]: On MetricFlow_create_from_dataframe: COMMIT
[0m16:29:58.096166 [debug] [MainThread]: Using duckdb connection "MetricFlow_create_from_dataframe"
[0m16:29:58.096408 [debug] [MainThread]: On MetricFlow_create_from_dataframe: COMMIT
[0m16:29:58.096719 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:58.097240 [debug] [MainThread]: Using duckdb connection "MetricFlow_create_from_dataframe"
[0m16:29:58.097495 [debug] [MainThread]: On MetricFlow_create_from_dataframe: BEGIN
[0m16:29:58.097792 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:58.098019 [debug] [MainThread]: Using duckdb connection "MetricFlow_create_from_dataframe"
[0m16:29:58.098248 [debug] [MainThread]: On MetricFlow_create_from_dataframe: INSERT INTO mf_test_snapshot_schema_rawaiued.example_snapshot VALUES (True, 1, 1, '2020-01-02 00:00:00', 'hi'),
(False, -1, -1, '2020-03-04 05:06:07', 'bye')
[0m16:29:58.098801 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:58.099408 [debug] [MainThread]: On MetricFlow_create_from_dataframe: COMMIT
[0m16:29:58.099670 [debug] [MainThread]: Using duckdb connection "MetricFlow_create_from_dataframe"
[0m16:29:58.099929 [debug] [MainThread]: On MetricFlow_create_from_dataframe: COMMIT
[0m16:29:58.100307 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:58.100562 [debug] [MainThread]: On MetricFlow_create_from_dataframe: Close
[0m16:29:58.100902 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_create_from_dataframe, now MetricFlow_request_mf_rid__79ml5tdb)
[0m16:29:58.101158 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__79ml5tdb"
[0m16:29:58.101441 [debug] [MainThread]: On MetricFlow_request_mf_rid__79ml5tdb: BEGIN
[0m16:29:58.101671 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:58.101976 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:58.102199 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__79ml5tdb"
[0m16:29:58.102421 [debug] [MainThread]: On MetricFlow_request_mf_rid__79ml5tdb: SELECT * FROM mf_test_snapshot_schema_rawaiued.example_snapshot
[0m16:29:58.102867 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:58.103665 [debug] [MainThread]: On MetricFlow_request_mf_rid__79ml5tdb: ROLLBACK
[0m16:29:58.103988 [debug] [MainThread]: Failed to rollback 'MetricFlow_request_mf_rid__79ml5tdb'
[0m16:29:58.104214 [debug] [MainThread]: On MetricFlow_request_mf_rid__79ml5tdb: Close
[0m16:29:58.108300 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__79ml5tdb, now MetricFlow_request_mf_rid__swusvu02)
[0m16:29:58.108619 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__swusvu02"
[0m16:29:58.108862 [debug] [MainThread]: On MetricFlow_request_mf_rid__swusvu02: BEGIN
[0m16:29:58.109090 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:58.109419 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:58.109647 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__swusvu02"
[0m16:29:58.109874 [debug] [MainThread]: On MetricFlow_request_mf_rid__swusvu02: DROP SCHEMA IF EXISTS mf_test_snapshot_schema_rawaiued CASCADE
[0m16:29:58.110164 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:58.110738 [debug] [MainThread]: On MetricFlow_request_mf_rid__swusvu02: COMMIT
[0m16:29:58.110978 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__swusvu02"
[0m16:29:58.111204 [debug] [MainThread]: On MetricFlow_request_mf_rid__swusvu02: COMMIT
[0m16:29:58.112889 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:58.113327 [debug] [MainThread]: On MetricFlow_request_mf_rid__swusvu02: Close
[0m16:29:58.125802 [debug] [MainThread]: Re-using an available connection from the pool (formerly MetricFlow_request_mf_rid__swusvu02, now MetricFlow_request_mf_rid__t75rmtda)
[0m16:29:58.126181 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__t75rmtda"
[0m16:29:58.126436 [debug] [MainThread]: On MetricFlow_request_mf_rid__t75rmtda: BEGIN
[0m16:29:58.126668 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:58.127055 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:58.127290 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__t75rmtda"
[0m16:29:58.127520 [debug] [MainThread]: On MetricFlow_request_mf_rid__t75rmtda: DROP SCHEMA IF EXISTS ***** CASCADE
[0m16:29:58.128112 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:58.128696 [debug] [MainThread]: On MetricFlow_request_mf_rid__t75rmtda: COMMIT
[0m16:29:58.128938 [debug] [MainThread]: Using duckdb connection "MetricFlow_request_mf_rid__t75rmtda"
[0m16:29:58.129164 [debug] [MainThread]: On MetricFlow_request_mf_rid__t75rmtda: COMMIT
[0m16:29:58.130048 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:58.130297 [debug] [MainThread]: On MetricFlow_request_mf_rid__t75rmtda: Close
